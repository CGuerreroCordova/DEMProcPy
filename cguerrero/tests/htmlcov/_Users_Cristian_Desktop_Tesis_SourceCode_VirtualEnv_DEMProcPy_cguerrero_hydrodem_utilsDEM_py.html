<!DOCTYPE html>
<html>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">


    <meta content="IE=emulateIE7" http-equiv="X-UA-Compatible"/>
    <title>Coverage for
        C:\Users\Cristian\Desktop\Tesis\SourceCode\VirtualEnv\DEMProcPy\cguerrero\hydrodem\utilsDEM.py:
        99%</title>
    <link href="style.css" rel="stylesheet" type="text/css">

    <script src="jquery.min.js" type="text/javascript"></script>
    <script src="jquery.hotkeys.js" type="text/javascript"></script>
    <script src="jquery.isonscreen.js" type="text/javascript"></script>
    <script src="coverage_html.js" type="text/javascript"></script>
    <script type="text/javascript">
        jQuery(document).ready(coverage.pyfile_ready);

    </script>
</head>
<body class="pyfile">

<div id="header">
    <div class="content">
        <h1>Coverage for <b>C:\Users\Cristian\Desktop\Tesis\SourceCode\VirtualEnv\DEMProcPy\cguerrero\hydrodem\utilsDEM.py</b>
            :
            <span class="pc_cov">99%</span>
        </h1>

        <img alt="Show keyboard shortcuts" id="keyboard_icon"
             src="keybd_closed.png"/>

        <h2 class="stats">
            325 statements &nbsp;
            <span class="run hide_run shortkey_r button_toggle_run">321 run</span>
            <span class="mis shortkey_m button_toggle_mis">4 missing</span>
            <span class="exc shortkey_x button_toggle_exc">0 excluded</span>


        </h2>
    </div>
</div>

<div class="help_panel">
    <img alt="Hide keyboard shortcuts" id="panel_icon" src="keybd_open.png"/>
    <p class="legend">Hot-keys on this page</p>
    <div>
        <p class="keyhelp">
            <span class="key">r</span>
            <span class="key">m</span>
            <span class="key">x</span>
            <span class="key">p</span> &nbsp; toggle line displays
        </p>
        <p class="keyhelp">
            <span class="key">j</span>
            <span class="key">k</span> &nbsp; next/prev highlighted chunk
        </p>
        <p class="keyhelp">
            <span class="key">0</span> &nbsp; (zero) top of page
        </p>
        <p class="keyhelp">
            <span class="key">1</span> &nbsp; (one) first highlighted chunk
        </p>
    </div>
</div>

<div id="source">
    <table>
        <tr>
            <td class="linenos">
                <p class="stm run hide_run" id="n1"><a href="#n1">1</a></p>
                <p class="stm run hide_run" id="n2"><a href="#n2">2</a></p>
                <p class="stm run hide_run" id="n3"><a href="#n3">3</a></p>
                <p class="stm run hide_run" id="n4"><a href="#n4">4</a></p>
                <p class="stm run hide_run" id="n5"><a href="#n5">5</a></p>
                <p class="stm run hide_run" id="n6"><a href="#n6">6</a></p>
                <p class="pln" id="n7"><a href="#n7">7</a></p>
                <p class="stm run hide_run" id="n8"><a href="#n8">8</a></p>
                <p class="stm run hide_run" id="n9"><a href="#n9">9</a></p>
                <p class="stm run hide_run" id="n10"><a href="#n10">10</a></p>
                <p class="stm run hide_run" id="n11"><a href="#n11">11</a></p>
                <p class="stm run hide_run" id="n12"><a href="#n12">12</a></p>
                <p class="pln" id="n13"><a href="#n13">13</a></p>
                <p class="stm run hide_run" id="n14"><a href="#n14">14</a></p>
                <p class="stm run hide_run" id="n15"><a href="#n15">15</a></p>
                <p class="stm run hide_run" id="n16"><a href="#n16">16</a></p>
                <p class="stm run hide_run" id="n17"><a href="#n17">17</a></p>
                <p class="stm run hide_run" id="n18"><a href="#n18">18</a></p>
                <p class="stm run hide_run" id="n19"><a href="#n19">19</a></p>
                <p class="stm run hide_run" id="n20"><a href="#n20">20</a></p>
                <p class="stm run hide_run" id="n21"><a href="#n21">21</a></p>
                <p class="stm run hide_run" id="n22"><a href="#n22">22</a></p>
                <p class="pln" id="n23"><a href="#n23">23</a></p>
                <p class="stm run hide_run" id="n24"><a href="#n24">24</a></p>
                <p class="pln" id="n25"><a href="#n25">25</a></p>
                <p class="pln" id="n26"><a href="#n26">26</a></p>
                <p class="stm run hide_run" id="n27"><a href="#n27">27</a></p>
                <p class="pln" id="n28"><a href="#n28">28</a></p>
                <p class="pln" id="n29"><a href="#n29">29</a></p>
                <p class="pln" id="n30"><a href="#n30">30</a></p>
                <p class="pln" id="n31"><a href="#n31">31</a></p>
                <p class="pln" id="n32"><a href="#n32">32</a></p>
                <p class="pln" id="n33"><a href="#n33">33</a></p>
                <p class="stm run hide_run" id="n34"><a href="#n34">34</a></p>
                <p class="stm run hide_run" id="n35"><a href="#n35">35</a></p>
                <p class="stm run hide_run" id="n36"><a href="#n36">36</a></p>
                <p class="stm run hide_run" id="n37"><a href="#n37">37</a></p>
                <p class="stm run hide_run" id="n38"><a href="#n38">38</a></p>
                <p class="stm run hide_run" id="n39"><a href="#n39">39</a></p>
                <p class="stm run hide_run" id="n40"><a href="#n40">40</a></p>
                <p class="stm run hide_run" id="n41"><a href="#n41">41</a></p>
                <p class="pln" id="n42"><a href="#n42">42</a></p>
                <p class="stm run hide_run" id="n43"><a href="#n43">43</a></p>
                <p class="stm run hide_run" id="n44"><a href="#n44">44</a></p>
                <p class="stm run hide_run" id="n45"><a href="#n45">45</a></p>
                <p class="pln" id="n46"><a href="#n46">46</a></p>
                <p class="stm run hide_run" id="n47"><a href="#n47">47</a></p>
                <p class="stm run hide_run" id="n48"><a href="#n48">48</a></p>
                <p class="stm run hide_run" id="n49"><a href="#n49">49</a></p>
                <p class="stm run hide_run" id="n50"><a href="#n50">50</a></p>
                <p class="stm run hide_run" id="n51"><a href="#n51">51</a></p>
                <p class="stm run hide_run" id="n52"><a href="#n52">52</a></p>
                <p class="pln" id="n53"><a href="#n53">53</a></p>
                <p class="pln" id="n54"><a href="#n54">54</a></p>
                <p class="stm run hide_run" id="n55"><a href="#n55">55</a></p>
                <p class="pln" id="n56"><a href="#n56">56</a></p>
                <p class="pln" id="n57"><a href="#n57">57</a></p>
                <p class="pln" id="n58"><a href="#n58">58</a></p>
                <p class="pln" id="n59"><a href="#n59">59</a></p>
                <p class="pln" id="n60"><a href="#n60">60</a></p>
                <p class="pln" id="n61"><a href="#n61">61</a></p>
                <p class="stm run hide_run" id="n62"><a href="#n62">62</a></p>
                <p class="stm run hide_run" id="n63"><a href="#n63">63</a></p>
                <p class="stm run hide_run" id="n64"><a href="#n64">64</a></p>
                <p class="stm run hide_run" id="n65"><a href="#n65">65</a></p>
                <p class="stm run hide_run" id="n66"><a href="#n66">66</a></p>
                <p class="stm run hide_run" id="n67"><a href="#n67">67</a></p>
                <p class="stm run hide_run" id="n68"><a href="#n68">68</a></p>
                <p class="pln" id="n69"><a href="#n69">69</a></p>
                <p class="stm run hide_run" id="n70"><a href="#n70">70</a></p>
                <p class="pln" id="n71"><a href="#n71">71</a></p>
                <p class="pln" id="n72"><a href="#n72">72</a></p>
                <p class="pln" id="n73"><a href="#n73">73</a></p>
                <p class="pln" id="n74"><a href="#n74">74</a></p>
                <p class="stm run hide_run" id="n75"><a href="#n75">75</a></p>
                <p class="stm run hide_run" id="n76"><a href="#n76">76</a></p>
                <p class="stm run hide_run" id="n77"><a href="#n77">77</a></p>
                <p class="stm run hide_run" id="n78"><a href="#n78">78</a></p>
                <p class="stm run hide_run" id="n79"><a href="#n79">79</a></p>
                <p class="stm run hide_run" id="n80"><a href="#n80">80</a></p>
                <p class="stm run hide_run" id="n81"><a href="#n81">81</a></p>
                <p class="stm run hide_run" id="n82"><a href="#n82">82</a></p>
                <p class="pln" id="n83"><a href="#n83">83</a></p>
                <p class="pln" id="n84"><a href="#n84">84</a></p>
                <p class="pln" id="n85"><a href="#n85">85</a></p>
                <p class="stm run hide_run" id="n86"><a href="#n86">86</a></p>
                <p class="pln" id="n87"><a href="#n87">87</a></p>
                <p class="pln" id="n88"><a href="#n88">88</a></p>
                <p class="pln" id="n89"><a href="#n89">89</a></p>
                <p class="pln" id="n90"><a href="#n90">90</a></p>
                <p class="stm run hide_run" id="n91"><a href="#n91">91</a></p>
                <p class="pln" id="n92"><a href="#n92">92</a></p>
                <p class="stm run hide_run" id="n93"><a href="#n93">93</a></p>
                <p class="stm run hide_run" id="n94"><a href="#n94">94</a></p>
                <p class="stm run hide_run" id="n95"><a href="#n95">95</a></p>
                <p class="stm run hide_run" id="n96"><a href="#n96">96</a></p>
                <p class="pln" id="n97"><a href="#n97">97</a></p>
                <p class="pln" id="n98"><a href="#n98">98</a></p>
                <p class="stm run hide_run" id="n99"><a href="#n99">99</a></p>
                <p class="pln" id="n100"><a href="#n100">100</a></p>
                <p class="pln" id="n101"><a href="#n101">101</a></p>
                <p class="pln" id="n102"><a href="#n102">102</a></p>
                <p class="pln" id="n103"><a href="#n103">103</a></p>
                <p class="stm run hide_run" id="n104"><a href="#n104">104</a>
                </p>
                <p class="stm run hide_run" id="n105"><a href="#n105">105</a>
                </p>
                <p class="stm run hide_run" id="n106"><a href="#n106">106</a>
                </p>
                <p class="stm run hide_run" id="n107"><a href="#n107">107</a>
                </p>
                <p class="stm run hide_run" id="n108"><a href="#n108">108</a>
                </p>
                <p class="stm run hide_run" id="n109"><a href="#n109">109</a>
                </p>
                <p class="stm run hide_run" id="n110"><a href="#n110">110</a>
                </p>
                <p class="stm run hide_run" id="n111"><a href="#n111">111</a>
                </p>
                <p class="stm run hide_run" id="n112"><a href="#n112">112</a>
                </p>
                <p class="pln" id="n113"><a href="#n113">113</a></p>
                <p class="pln" id="n114"><a href="#n114">114</a></p>
                <p class="pln" id="n115"><a href="#n115">115</a></p>
                <p class="stm run hide_run" id="n116"><a href="#n116">116</a>
                </p>
                <p class="pln" id="n117"><a href="#n117">117</a></p>
                <p class="pln" id="n118"><a href="#n118">118</a></p>
                <p class="pln" id="n119"><a href="#n119">119</a></p>
                <p class="pln" id="n120"><a href="#n120">120</a></p>
                <p class="stm run hide_run" id="n121"><a href="#n121">121</a>
                </p>
                <p class="stm run hide_run" id="n122"><a href="#n122">122</a>
                </p>
                <p class="stm run hide_run" id="n123"><a href="#n123">123</a>
                </p>
                <p class="stm run hide_run" id="n124"><a href="#n124">124</a>
                </p>
                <p class="stm run hide_run" id="n125"><a href="#n125">125</a>
                </p>
                <p class="stm run hide_run" id="n126"><a href="#n126">126</a>
                </p>
                <p class="pln" id="n127"><a href="#n127">127</a></p>
                <p class="pln" id="n128"><a href="#n128">128</a></p>
                <p class="stm run hide_run" id="n129"><a href="#n129">129</a>
                </p>
                <p class="pln" id="n130"><a href="#n130">130</a></p>
                <p class="pln" id="n131"><a href="#n131">131</a></p>
                <p class="pln" id="n132"><a href="#n132">132</a></p>
                <p class="stm run hide_run" id="n133"><a href="#n133">133</a>
                </p>
                <p class="stm run hide_run" id="n134"><a href="#n134">134</a>
                </p>
                <p class="stm run hide_run" id="n135"><a href="#n135">135</a>
                </p>
                <p class="stm run hide_run" id="n136"><a href="#n136">136</a>
                </p>
                <p class="stm run hide_run" id="n137"><a href="#n137">137</a>
                </p>
                <p class="stm run hide_run" id="n138"><a href="#n138">138</a>
                </p>
                <p class="stm run hide_run" id="n139"><a href="#n139">139</a>
                </p>
                <p class="stm run hide_run" id="n140"><a href="#n140">140</a>
                </p>
                <p class="stm run hide_run" id="n141"><a href="#n141">141</a>
                </p>
                <p class="stm run hide_run" id="n142"><a href="#n142">142</a>
                </p>
                <p class="stm run hide_run" id="n143"><a href="#n143">143</a>
                </p>
                <p class="stm run hide_run" id="n144"><a href="#n144">144</a>
                </p>
                <p class="pln" id="n145"><a href="#n145">145</a></p>
                <p class="stm run hide_run" id="n146"><a href="#n146">146</a>
                </p>
                <p class="pln" id="n147"><a href="#n147">147</a></p>
                <p class="stm run hide_run" id="n148"><a href="#n148">148</a>
                </p>
                <p class="stm run hide_run" id="n149"><a href="#n149">149</a>
                </p>
                <p class="stm run hide_run" id="n150"><a href="#n150">150</a>
                </p>
                <p class="stm run hide_run" id="n151"><a href="#n151">151</a>
                </p>
                <p class="stm run hide_run" id="n152"><a href="#n152">152</a>
                </p>
                <p class="stm run hide_run" id="n153"><a href="#n153">153</a>
                </p>
                <p class="stm run hide_run" id="n154"><a href="#n154">154</a>
                </p>
                <p class="stm run hide_run" id="n155"><a href="#n155">155</a>
                </p>
                <p class="stm run hide_run" id="n156"><a href="#n156">156</a>
                </p>
                <p class="stm run hide_run" id="n157"><a href="#n157">157</a>
                </p>
                <p class="stm run hide_run" id="n158"><a href="#n158">158</a>
                </p>
                <p class="pln" id="n159"><a href="#n159">159</a></p>
                <p class="pln" id="n160"><a href="#n160">160</a></p>
                <p class="stm run hide_run" id="n161"><a href="#n161">161</a>
                </p>
                <p class="pln" id="n162"><a href="#n162">162</a></p>
                <p class="pln" id="n163"><a href="#n163">163</a></p>
                <p class="pln" id="n164"><a href="#n164">164</a></p>
                <p class="pln" id="n165"><a href="#n165">165</a></p>
                <p class="stm run hide_run" id="n166"><a href="#n166">166</a>
                </p>
                <p class="stm run hide_run" id="n167"><a href="#n167">167</a>
                </p>
                <p class="pln" id="n168"><a href="#n168">168</a></p>
                <p class="stm run hide_run" id="n169"><a href="#n169">169</a>
                </p>
                <p class="stm run hide_run" id="n170"><a href="#n170">170</a>
                </p>
                <p class="stm run hide_run" id="n171"><a href="#n171">171</a>
                </p>
                <p class="stm run hide_run" id="n172"><a href="#n172">172</a>
                </p>
                <p class="stm run hide_run" id="n173"><a href="#n173">173</a>
                </p>
                <p class="stm run hide_run" id="n174"><a href="#n174">174</a>
                </p>
                <p class="stm run hide_run" id="n175"><a href="#n175">175</a>
                </p>
                <p class="stm run hide_run" id="n176"><a href="#n176">176</a>
                </p>
                <p class="stm run hide_run" id="n177"><a href="#n177">177</a>
                </p>
                <p class="stm run hide_run" id="n178"><a href="#n178">178</a>
                </p>
                <p class="stm run hide_run" id="n179"><a href="#n179">179</a>
                </p>
                <p class="stm run hide_run" id="n180"><a href="#n180">180</a>
                </p>
                <p class="stm run hide_run" id="n181"><a href="#n181">181</a>
                </p>
                <p class="stm run hide_run" id="n182"><a href="#n182">182</a>
                </p>
                <p class="pln" id="n183"><a href="#n183">183</a></p>
                <p class="stm run hide_run" id="n184"><a href="#n184">184</a>
                </p>
                <p class="stm run hide_run" id="n185"><a href="#n185">185</a>
                </p>
                <p class="pln" id="n186"><a href="#n186">186</a></p>
                <p class="stm run hide_run" id="n187"><a href="#n187">187</a>
                </p>
                <p class="pln" id="n188"><a href="#n188">188</a></p>
                <p class="pln" id="n189"><a href="#n189">189</a></p>
                <p class="pln" id="n190"><a href="#n190">190</a></p>
                <p class="stm run hide_run" id="n191"><a href="#n191">191</a>
                </p>
                <p class="stm run hide_run" id="n192"><a href="#n192">192</a>
                </p>
                <p class="stm run hide_run" id="n193"><a href="#n193">193</a>
                </p>
                <p class="stm run hide_run" id="n194"><a href="#n194">194</a>
                </p>
                <p class="stm run hide_run" id="n195"><a href="#n195">195</a>
                </p>
                <p class="stm run hide_run" id="n196"><a href="#n196">196</a>
                </p>
                <p class="stm run hide_run" id="n197"><a href="#n197">197</a>
                </p>
                <p class="stm run hide_run" id="n198"><a href="#n198">198</a>
                </p>
                <p class="stm run hide_run" id="n199"><a href="#n199">199</a>
                </p>
                <p class="pln" id="n200"><a href="#n200">200</a></p>
                <p class="pln" id="n201"><a href="#n201">201</a></p>
                <p class="stm run hide_run" id="n202"><a href="#n202">202</a>
                </p>
                <p class="stm run hide_run" id="n203"><a href="#n203">203</a>
                </p>
                <p class="stm run hide_run" id="n204"><a href="#n204">204</a>
                </p>
                <p class="stm run hide_run" id="n205"><a href="#n205">205</a>
                </p>
                <p class="stm run hide_run" id="n206"><a href="#n206">206</a>
                </p>
                <p class="stm run hide_run" id="n207"><a href="#n207">207</a>
                </p>
                <p class="stm run hide_run" id="n208"><a href="#n208">208</a>
                </p>
                <p class="stm run hide_run" id="n209"><a href="#n209">209</a>
                </p>
                <p class="stm run hide_run" id="n210"><a href="#n210">210</a>
                </p>
                <p class="pln" id="n211"><a href="#n211">211</a></p>
                <p class="pln" id="n212"><a href="#n212">212</a></p>
                <p class="stm run hide_run" id="n213"><a href="#n213">213</a>
                </p>
                <p class="pln" id="n214"><a href="#n214">214</a></p>
                <p class="pln" id="n215"><a href="#n215">215</a></p>
                <p class="pln" id="n216"><a href="#n216">216</a></p>
                <p class="stm run hide_run" id="n217"><a href="#n217">217</a>
                </p>
                <p class="stm run hide_run" id="n218"><a href="#n218">218</a>
                </p>
                <p class="stm run hide_run" id="n219"><a href="#n219">219</a>
                </p>
                <p class="stm run hide_run" id="n220"><a href="#n220">220</a>
                </p>
                <p class="stm run hide_run" id="n221"><a href="#n221">221</a>
                </p>
                <p class="stm run hide_run" id="n222"><a href="#n222">222</a>
                </p>
                <p class="stm run hide_run" id="n223"><a href="#n223">223</a>
                </p>
                <p class="stm run hide_run" id="n224"><a href="#n224">224</a>
                </p>
                <p class="stm run hide_run" id="n225"><a href="#n225">225</a>
                </p>
                <p class="stm run hide_run" id="n226"><a href="#n226">226</a>
                </p>
                <p class="pln" id="n227"><a href="#n227">227</a></p>
                <p class="pln" id="n228"><a href="#n228">228</a></p>
                <p class="pln" id="n229"><a href="#n229">229</a></p>
                <p class="stm run hide_run" id="n230"><a href="#n230">230</a>
                </p>
                <p class="pln" id="n231"><a href="#n231">231</a></p>
                <p class="pln" id="n232"><a href="#n232">232</a></p>
                <p class="pln" id="n233"><a href="#n233">233</a></p>
                <p class="stm run hide_run" id="n234"><a href="#n234">234</a>
                </p>
                <p class="pln" id="n235"><a href="#n235">235</a></p>
                <p class="pln" id="n236"><a href="#n236">236</a></p>
                <p class="stm run hide_run" id="n237"><a href="#n237">237</a>
                </p>
                <p class="pln" id="n238"><a href="#n238">238</a></p>
                <p class="pln" id="n239"><a href="#n239">239</a></p>
                <p class="stm run hide_run" id="n240"><a href="#n240">240</a>
                </p>
                <p class="pln" id="n241"><a href="#n241">241</a></p>
                <p class="stm run hide_run" id="n242"><a href="#n242">242</a>
                </p>
                <p class="stm run hide_run" id="n243"><a href="#n243">243</a>
                </p>
                <p class="stm run hide_run" id="n244"><a href="#n244">244</a>
                </p>
                <p class="pln" id="n245"><a href="#n245">245</a></p>
                <p class="pln" id="n246"><a href="#n246">246</a></p>
                <p class="stm run hide_run" id="n247"><a href="#n247">247</a>
                </p>
                <p class="pln" id="n248"><a href="#n248">248</a></p>
                <p class="pln" id="n249"><a href="#n249">249</a></p>
                <p class="pln" id="n250"><a href="#n250">250</a></p>
                <p class="stm run hide_run" id="n251"><a href="#n251">251</a>
                </p>
                <p class="stm run hide_run" id="n252"><a href="#n252">252</a>
                </p>
                <p class="stm run hide_run" id="n253"><a href="#n253">253</a>
                </p>
                <p class="stm run hide_run" id="n254"><a href="#n254">254</a>
                </p>
                <p class="stm run hide_run" id="n255"><a href="#n255">255</a>
                </p>
                <p class="stm run hide_run" id="n256"><a href="#n256">256</a>
                </p>
                <p class="stm run hide_run" id="n257"><a href="#n257">257</a>
                </p>
                <p class="stm run hide_run" id="n258"><a href="#n258">258</a>
                </p>
                <p class="stm run hide_run" id="n259"><a href="#n259">259</a>
                </p>
                <p class="stm run hide_run" id="n260"><a href="#n260">260</a>
                </p>
                <p class="pln" id="n261"><a href="#n261">261</a></p>
                <p class="pln" id="n262"><a href="#n262">262</a></p>
                <p class="pln" id="n263"><a href="#n263">263</a></p>
                <p class="pln" id="n264"><a href="#n264">264</a></p>
                <p class="stm run hide_run" id="n265"><a href="#n265">265</a>
                </p>
                <p class="pln" id="n266"><a href="#n266">266</a></p>
                <p class="pln" id="n267"><a href="#n267">267</a></p>
                <p class="pln" id="n268"><a href="#n268">268</a></p>
                <p class="stm run hide_run" id="n269"><a href="#n269">269</a>
                </p>
                <p class="stm run hide_run" id="n270"><a href="#n270">270</a>
                </p>
                <p class="pln" id="n271"><a href="#n271">271</a></p>
                <p class="pln" id="n272"><a href="#n272">272</a></p>
                <p class="pln" id="n273"><a href="#n273">273</a></p>
                <p class="pln" id="n274"><a href="#n274">274</a></p>
                <p class="stm run hide_run" id="n275"><a href="#n275">275</a>
                </p>
                <p class="pln" id="n276"><a href="#n276">276</a></p>
                <p class="pln" id="n277"><a href="#n277">277</a></p>
                <p class="pln" id="n278"><a href="#n278">278</a></p>
                <p class="stm run hide_run" id="n279"><a href="#n279">279</a>
                </p>
                <p class="stm run hide_run" id="n280"><a href="#n280">280</a>
                </p>
                <p class="pln" id="n281"><a href="#n281">281</a></p>
                <p class="pln" id="n282"><a href="#n282">282</a></p>
                <p class="pln" id="n283"><a href="#n283">283</a></p>
                <p class="stm run hide_run" id="n284"><a href="#n284">284</a>
                </p>
                <p class="pln" id="n285"><a href="#n285">285</a></p>
                <p class="pln" id="n286"><a href="#n286">286</a></p>
                <p class="stm run hide_run" id="n287"><a href="#n287">287</a>
                </p>
                <p class="stm run hide_run" id="n288"><a href="#n288">288</a>
                </p>
                <p class="pln" id="n289"><a href="#n289">289</a></p>
                <p class="stm run hide_run" id="n290"><a href="#n290">290</a>
                </p>
                <p class="pln" id="n291"><a href="#n291">291</a></p>
                <p class="pln" id="n292"><a href="#n292">292</a></p>
                <p class="stm run hide_run" id="n293"><a href="#n293">293</a>
                </p>
                <p class="pln" id="n294"><a href="#n294">294</a></p>
                <p class="stm run hide_run" id="n295"><a href="#n295">295</a>
                </p>
                <p class="stm run hide_run" id="n296"><a href="#n296">296</a>
                </p>
                <p class="stm run hide_run" id="n297"><a href="#n297">297</a>
                </p>
                <p class="stm run hide_run" id="n298"><a href="#n298">298</a>
                </p>
                <p class="stm run hide_run" id="n299"><a href="#n299">299</a>
                </p>
                <p class="stm run hide_run" id="n300"><a href="#n300">300</a>
                </p>
                <p class="stm run hide_run" id="n301"><a href="#n301">301</a>
                </p>
                <p class="pln" id="n302"><a href="#n302">302</a></p>
                <p class="pln" id="n303"><a href="#n303">303</a></p>
                <p class="stm run hide_run" id="n304"><a href="#n304">304</a>
                </p>
                <p class="pln" id="n305"><a href="#n305">305</a></p>
                <p class="pln" id="n306"><a href="#n306">306</a></p>
                <p class="pln" id="n307"><a href="#n307">307</a></p>
                <p class="pln" id="n308"><a href="#n308">308</a></p>
                <p class="pln" id="n309"><a href="#n309">309</a></p>
                <p class="pln" id="n310"><a href="#n310">310</a></p>
                <p class="stm run hide_run" id="n311"><a href="#n311">311</a>
                </p>
                <p class="stm run hide_run" id="n312"><a href="#n312">312</a>
                </p>
                <p class="stm run hide_run" id="n313"><a href="#n313">313</a>
                </p>
                <p class="pln" id="n314"><a href="#n314">314</a></p>
                <p class="stm run hide_run" id="n315"><a href="#n315">315</a>
                </p>
                <p class="stm run hide_run" id="n316"><a href="#n316">316</a>
                </p>
                <p class="stm run hide_run" id="n317"><a href="#n317">317</a>
                </p>
                <p class="pln" id="n318"><a href="#n318">318</a></p>
                <p class="stm run hide_run" id="n319"><a href="#n319">319</a>
                </p>
                <p class="stm run hide_run" id="n320"><a href="#n320">320</a>
                </p>
                <p class="stm run hide_run" id="n321"><a href="#n321">321</a>
                </p>
                <p class="stm run hide_run" id="n322"><a href="#n322">322</a>
                </p>
                <p class="stm run hide_run" id="n323"><a href="#n323">323</a>
                </p>
                <p class="pln" id="n324"><a href="#n324">324</a></p>
                <p class="pln" id="n325"><a href="#n325">325</a></p>
                <p class="stm run hide_run" id="n326"><a href="#n326">326</a>
                </p>
                <p class="pln" id="n327"><a href="#n327">327</a></p>
                <p class="pln" id="n328"><a href="#n328">328</a></p>
                <p class="pln" id="n329"><a href="#n329">329</a></p>
                <p class="stm run hide_run" id="n330"><a href="#n330">330</a>
                </p>
                <p class="stm run hide_run" id="n331"><a href="#n331">331</a>
                </p>
                <p class="stm run hide_run" id="n332"><a href="#n332">332</a>
                </p>
                <p class="stm run hide_run" id="n333"><a href="#n333">333</a>
                </p>
                <p class="stm run hide_run" id="n334"><a href="#n334">334</a>
                </p>
                <p class="stm run hide_run" id="n335"><a href="#n335">335</a>
                </p>
                <p class="stm run hide_run" id="n336"><a href="#n336">336</a>
                </p>
                <p class="stm run hide_run" id="n337"><a href="#n337">337</a>
                </p>
                <p class="stm run hide_run" id="n338"><a href="#n338">338</a>
                </p>
                <p class="stm run hide_run" id="n339"><a href="#n339">339</a>
                </p>
                <p class="stm run hide_run" id="n340"><a href="#n340">340</a>
                </p>
                <p class="stm run hide_run" id="n341"><a href="#n341">341</a>
                </p>
                <p class="pln" id="n342"><a href="#n342">342</a></p>
                <p class="pln" id="n343"><a href="#n343">343</a></p>
                <p class="pln" id="n344"><a href="#n344">344</a></p>
                <p class="stm run hide_run" id="n345"><a href="#n345">345</a>
                </p>
                <p class="pln" id="n346"><a href="#n346">346</a></p>
                <p class="pln" id="n347"><a href="#n347">347</a></p>
                <p class="pln" id="n348"><a href="#n348">348</a></p>
                <p class="stm run hide_run" id="n349"><a href="#n349">349</a>
                </p>
                <p class="stm run hide_run" id="n350"><a href="#n350">350</a>
                </p>
                <p class="pln" id="n351"><a href="#n351">351</a></p>
                <p class="stm run hide_run" id="n352"><a href="#n352">352</a>
                </p>
                <p class="stm run hide_run" id="n353"><a href="#n353">353</a>
                </p>
                <p class="stm run hide_run" id="n354"><a href="#n354">354</a>
                </p>
                <p class="stm run hide_run" id="n355"><a href="#n355">355</a>
                </p>
                <p class="stm run hide_run" id="n356"><a href="#n356">356</a>
                </p>
                <p class="pln" id="n357"><a href="#n357">357</a></p>
                <p class="stm run hide_run" id="n358"><a href="#n358">358</a>
                </p>
                <p class="pln" id="n359"><a href="#n359">359</a></p>
                <p class="stm run hide_run" id="n360"><a href="#n360">360</a>
                </p>
                <p class="stm run hide_run" id="n361"><a href="#n361">361</a>
                </p>
                <p class="stm run hide_run" id="n362"><a href="#n362">362</a>
                </p>
                <p class="stm run hide_run" id="n363"><a href="#n363">363</a>
                </p>
                <p class="stm run hide_run" id="n364"><a href="#n364">364</a>
                </p>
                <p class="pln" id="n365"><a href="#n365">365</a></p>
                <p class="stm run hide_run" id="n366"><a href="#n366">366</a>
                </p>
                <p class="stm run hide_run" id="n367"><a href="#n367">367</a>
                </p>
                <p class="stm run hide_run" id="n368"><a href="#n368">368</a>
                </p>
                <p class="stm run hide_run" id="n369"><a href="#n369">369</a>
                </p>
                <p class="stm run hide_run" id="n370"><a href="#n370">370</a>
                </p>
                <p class="pln" id="n371"><a href="#n371">371</a></p>
                <p class="stm run hide_run" id="n372"><a href="#n372">372</a>
                </p>
                <p class="stm run hide_run" id="n373"><a href="#n373">373</a>
                </p>
                <p class="pln" id="n374"><a href="#n374">374</a></p>
                <p class="stm run hide_run" id="n375"><a href="#n375">375</a>
                </p>
                <p class="stm run hide_run" id="n376"><a href="#n376">376</a>
                </p>
                <p class="stm run hide_run" id="n377"><a href="#n377">377</a>
                </p>
                <p class="pln" id="n378"><a href="#n378">378</a></p>
                <p class="stm run hide_run" id="n379"><a href="#n379">379</a>
                </p>
                <p class="pln" id="n380"><a href="#n380">380</a></p>
                <p class="pln" id="n381"><a href="#n381">381</a></p>
                <p class="pln" id="n382"><a href="#n382">382</a></p>
                <p class="stm run hide_run" id="n383"><a href="#n383">383</a>
                </p>
                <p class="stm run hide_run" id="n384"><a href="#n384">384</a>
                </p>
                <p class="stm run hide_run" id="n385"><a href="#n385">385</a>
                </p>
                <p class="pln" id="n386"><a href="#n386">386</a></p>
                <p class="stm run hide_run" id="n387"><a href="#n387">387</a>
                </p>
                <p class="stm run hide_run" id="n388"><a href="#n388">388</a>
                </p>
                <p class="stm run hide_run" id="n389"><a href="#n389">389</a>
                </p>
                <p class="stm run hide_run" id="n390"><a href="#n390">390</a>
                </p>
                <p class="stm run hide_run" id="n391"><a href="#n391">391</a>
                </p>
                <p class="stm run hide_run" id="n392"><a href="#n392">392</a>
                </p>
                <p class="stm run hide_run" id="n393"><a href="#n393">393</a>
                </p>
                <p class="pln" id="n394"><a href="#n394">394</a></p>
                <p class="pln" id="n395"><a href="#n395">395</a></p>
                <p class="stm run hide_run" id="n396"><a href="#n396">396</a>
                </p>
                <p class="pln" id="n397"><a href="#n397">397</a></p>
                <p class="pln" id="n398"><a href="#n398">398</a></p>
                <p class="pln" id="n399"><a href="#n399">399</a></p>
                <p class="pln" id="n400"><a href="#n400">400</a></p>
                <p class="stm run hide_run" id="n401"><a href="#n401">401</a>
                </p>
                <p class="stm run hide_run" id="n402"><a href="#n402">402</a>
                </p>
                <p class="pln" id="n403"><a href="#n403">403</a></p>
                <p class="stm run hide_run" id="n404"><a href="#n404">404</a>
                </p>
                <p class="stm run hide_run" id="n405"><a href="#n405">405</a>
                </p>
                <p class="pln" id="n406"><a href="#n406">406</a></p>
                <p class="stm run hide_run" id="n407"><a href="#n407">407</a>
                </p>
                <p class="stm run hide_run" id="n408"><a href="#n408">408</a>
                </p>
                <p class="pln" id="n409"><a href="#n409">409</a></p>
                <p class="pln" id="n410"><a href="#n410">410</a></p>
                <p class="stm run hide_run" id="n411"><a href="#n411">411</a>
                </p>
                <p class="stm run hide_run" id="n412"><a href="#n412">412</a>
                </p>
                <p class="stm run hide_run" id="n413"><a href="#n413">413</a>
                </p>
                <p class="stm mis" id="n414"><a href="#n414">414</a></p>
                <p class="stm mis" id="n415"><a href="#n415">415</a></p>
                <p class="pln" id="n416"><a href="#n416">416</a></p>
                <p class="pln" id="n417"><a href="#n417">417</a></p>
                <p class="stm run hide_run" id="n418"><a href="#n418">418</a>
                </p>
                <p class="pln" id="n419"><a href="#n419">419</a></p>
                <p class="pln" id="n420"><a href="#n420">420</a></p>
                <p class="pln" id="n421"><a href="#n421">421</a></p>
                <p class="pln" id="n422"><a href="#n422">422</a></p>
                <p class="stm run hide_run" id="n423"><a href="#n423">423</a>
                </p>
                <p class="pln" id="n424"><a href="#n424">424</a></p>
                <p class="pln" id="n425"><a href="#n425">425</a></p>
                <p class="stm run hide_run" id="n426"><a href="#n426">426</a>
                </p>
                <p class="pln" id="n427"><a href="#n427">427</a></p>
                <p class="pln" id="n428"><a href="#n428">428</a></p>
                <p class="stm run hide_run" id="n429"><a href="#n429">429</a>
                </p>
                <p class="pln" id="n430"><a href="#n430">430</a></p>
                <p class="pln" id="n431"><a href="#n431">431</a></p>
                <p class="pln" id="n432"><a href="#n432">432</a></p>
                <p class="pln" id="n433"><a href="#n433">433</a></p>
                <p class="stm run hide_run" id="n434"><a href="#n434">434</a>
                </p>
                <p class="stm run hide_run" id="n435"><a href="#n435">435</a>
                </p>
                <p class="stm run hide_run" id="n436"><a href="#n436">436</a>
                </p>
                <p class="stm run hide_run" id="n437"><a href="#n437">437</a>
                </p>
                <p class="stm run hide_run" id="n438"><a href="#n438">438</a>
                </p>
                <p class="stm mis" id="n439"><a href="#n439">439</a></p>
                <p class="stm mis" id="n440"><a href="#n440">440</a></p>
                <p class="pln" id="n441"><a href="#n441">441</a></p>
                <p class="stm run hide_run" id="n442"><a href="#n442">442</a>
                </p>
                <p class="stm run hide_run" id="n443"><a href="#n443">443</a>
                </p>
                <p class="pln" id="n444"><a href="#n444">444</a></p>
                <p class="stm run hide_run" id="n445"><a href="#n445">445</a>
                </p>
                <p class="stm run hide_run" id="n446"><a href="#n446">446</a>
                </p>
                <p class="stm run hide_run" id="n447"><a href="#n447">447</a>
                </p>
                <p class="pln" id="n448"><a href="#n448">448</a></p>
                <p class="stm run hide_run" id="n449"><a href="#n449">449</a>
                </p>
                <p class="pln" id="n450"><a href="#n450">450</a></p>
                <p class="stm run hide_run" id="n451"><a href="#n451">451</a>
                </p>
                <p class="pln" id="n452"><a href="#n452">452</a></p>
                <p class="stm run hide_run" id="n453"><a href="#n453">453</a>
                </p>
                <p class="pln" id="n454"><a href="#n454">454</a></p>
                <p class="stm run hide_run" id="n455"><a href="#n455">455</a>
                </p>
                <p class="pln" id="n456"><a href="#n456">456</a></p>
                <p class="pln" id="n457"><a href="#n457">457</a></p>
                <p class="stm run hide_run" id="n458"><a href="#n458">458</a>
                </p>
                <p class="pln" id="n459"><a href="#n459">459</a></p>
                <p class="pln" id="n460"><a href="#n460">460</a></p>
                <p class="pln" id="n461"><a href="#n461">461</a></p>
                <p class="pln" id="n462"><a href="#n462">462</a></p>
                <p class="pln" id="n463"><a href="#n463">463</a></p>
                <p class="pln" id="n464"><a href="#n464">464</a></p>
                <p class="stm run hide_run" id="n465"><a href="#n465">465</a>
                </p>
                <p class="stm run hide_run" id="n466"><a href="#n466">466</a>
                </p>
                <p class="stm run hide_run" id="n467"><a href="#n467">467</a>
                </p>
                <p class="pln" id="n468"><a href="#n468">468</a></p>
                <p class="stm run hide_run" id="n469"><a href="#n469">469</a>
                </p>
                <p class="stm run hide_run" id="n470"><a href="#n470">470</a>
                </p>
                <p class="stm run hide_run" id="n471"><a href="#n471">471</a>
                </p>
                <p class="pln" id="n472"><a href="#n472">472</a></p>
                <p class="pln" id="n473"><a href="#n473">473</a></p>
                <p class="stm run hide_run" id="n474"><a href="#n474">474</a>
                </p>
                <p class="pln" id="n475"><a href="#n475">475</a></p>
                <p class="stm run hide_run" id="n476"><a href="#n476">476</a>
                </p>
                <p class="stm run hide_run" id="n477"><a href="#n477">477</a>
                </p>
                <p class="pln" id="n478"><a href="#n478">478</a></p>
                <p class="pln" id="n479"><a href="#n479">479</a></p>
                <p class="stm run hide_run" id="n480"><a href="#n480">480</a>
                </p>
                <p class="stm run hide_run" id="n481"><a href="#n481">481</a>
                </p>
                <p class="pln" id="n482"><a href="#n482">482</a></p>
                <p class="stm run hide_run" id="n483"><a href="#n483">483</a>
                </p>
                <p class="stm run hide_run" id="n484"><a href="#n484">484</a>
                </p>
                <p class="pln" id="n485"><a href="#n485">485</a></p>
                <p class="pln" id="n486"><a href="#n486">486</a></p>
                <p class="stm run hide_run" id="n487"><a href="#n487">487</a>
                </p>
                <p class="pln" id="n488"><a href="#n488">488</a></p>
                <p class="pln" id="n489"><a href="#n489">489</a></p>
                <p class="stm run hide_run" id="n490"><a href="#n490">490</a>
                </p>
                <p class="stm run hide_run" id="n491"><a href="#n491">491</a>
                </p>
                <p class="stm run hide_run" id="n492"><a href="#n492">492</a>
                </p>
                <p class="pln" id="n493"><a href="#n493">493</a></p>
                <p class="pln" id="n494"><a href="#n494">494</a></p>
                <p class="stm run hide_run" id="n495"><a href="#n495">495</a>
                </p>
                <p class="pln" id="n496"><a href="#n496">496</a></p>
                <p class="pln" id="n497"><a href="#n497">497</a></p>
                <p class="pln" id="n498"><a href="#n498">498</a></p>
                <p class="pln" id="n499"><a href="#n499">499</a></p>
                <p class="pln" id="n500"><a href="#n500">500</a></p>
                <p class="pln" id="n501"><a href="#n501">501</a></p>
                <p class="stm run hide_run" id="n502"><a href="#n502">502</a>
                </p>
                <p class="stm run hide_run" id="n503"><a href="#n503">503</a>
                </p>
                <p class="pln" id="n504"><a href="#n504">504</a></p>
                <p class="stm run hide_run" id="n505"><a href="#n505">505</a>
                </p>
                <p class="pln" id="n506"><a href="#n506">506</a></p>
                <p class="pln" id="n507"><a href="#n507">507</a></p>
                <p class="stm run hide_run" id="n508"><a href="#n508">508</a>
                </p>
                <p class="pln" id="n509"><a href="#n509">509</a></p>
                <p class="stm run hide_run" id="n510"><a href="#n510">510</a>
                </p>
                <p class="stm run hide_run" id="n511"><a href="#n511">511</a>
                </p>
                <p class="stm run hide_run" id="n512"><a href="#n512">512</a>
                </p>
                <p class="stm run hide_run" id="n513"><a href="#n513">513</a>
                </p>
                <p class="pln" id="n514"><a href="#n514">514</a></p>
                <p class="stm run hide_run" id="n515"><a href="#n515">515</a>
                </p>
                <p class="stm run hide_run" id="n516"><a href="#n516">516</a>
                </p>
                <p class="stm run hide_run" id="n517"><a href="#n517">517</a>
                </p>
                <p class="stm run hide_run" id="n518"><a href="#n518">518</a>
                </p>
                <p class="pln" id="n519"><a href="#n519">519</a></p>
                <p class="stm run hide_run" id="n520"><a href="#n520">520</a>
                </p>
                <p class="pln" id="n521"><a href="#n521">521</a></p>
                <p class="stm run hide_run" id="n522"><a href="#n522">522</a>
                </p>
                <p class="pln" id="n523"><a href="#n523">523</a></p>
                <p class="pln" id="n524"><a href="#n524">524</a></p>
                <p class="pln" id="n525"><a href="#n525">525</a></p>
                <p class="pln" id="n526"><a href="#n526">526</a></p>
                <p class="stm run hide_run" id="n527"><a href="#n527">527</a>
                </p>
                <p class="stm run hide_run" id="n528"><a href="#n528">528</a>
                </p>
                <p class="stm run hide_run" id="n529"><a href="#n529">529</a>
                </p>
                <p class="stm run hide_run" id="n530"><a href="#n530">530</a>
                </p>
                <p class="pln" id="n531"><a href="#n531">531</a></p>
                <p class="stm run hide_run" id="n532"><a href="#n532">532</a>
                </p>
                <p class="stm run hide_run" id="n533"><a href="#n533">533</a>
                </p>
                <p class="pln" id="n534"><a href="#n534">534</a></p>
                <p class="stm run hide_run" id="n535"><a href="#n535">535</a>
                </p>
                <p class="stm run hide_run" id="n536"><a href="#n536">536</a>
                </p>
                <p class="stm run hide_run" id="n537"><a href="#n537">537</a>
                </p>
                <p class="stm run hide_run" id="n538"><a href="#n538">538</a>
                </p>
                <p class="stm run hide_run" id="n539"><a href="#n539">539</a>
                </p>

            </td>
            <td class="text">
                <p class="stm run hide_run" id="t1"><span class="nam">__author__</span>
                    <span class="op">=</span> <span class="str">"Cristian Guerrero Cordova"</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t2"><span class="nam">__copyright__</span>
                    <span class="op">=</span> <span class="str">"Copyright 2017"</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t3"><span class="nam">__credits__</span>
                    <span class="op">=</span> <span class="op">[</span><span
                            class="str">"Cristian Guerrero Cordova"</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t4"><span class="nam">__version__</span>
                    <span class="op">=</span> <span
                            class="str">"0.1"</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t5"><span
                        class="nam">__email__</span> <span class="op">=</span>
                    <span class="str">"cguerrerocordova@gmail.com"</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t6"><span class="nam">__status__</span>
                    <span class="op">=</span> <span
                            class="str">"Developing"</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t7"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t8"><span
                        class="key">import</span> <span
                        class="nam">os</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t9"><span
                        class="key">import</span> <span
                        class="nam">subprocess</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t10"><span
                        class="key">from</span> <span
                        class="nam">collections</span> <span
                        class="key">import</span> <span
                        class="nam">Counter</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t11"><span
                        class="key">from</span> <span class="nam">multiprocessing</span>
                    <span class="key">import</span> <span
                            class="nam">Pool</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t12"><span
                        class="key">import</span> <span class="nam">glob</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t13"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t14"><span
                        class="key">import</span> <span
                        class="nam">datetime</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t15"><span
                        class="key">import</span> <span
                        class="nam">numpy</span> <span class="key">as</span>
                    <span class="nam">np</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t16"><span
                        class="key">import</span> <span
                        class="nam">ogr</span><span class="op">,</span> <span
                        class="nam">osr</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t17"><span
                        class="key">from</span> <span class="nam">osgeo</span>
                    <span class="key">import</span> <span
                            class="nam">gdal</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t18"><span
                        class="key">from</span> <span class="nam">scipy</span>
                    <span class="key">import</span> <span
                            class="nam">fftpack</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t19"><span
                        class="key">from</span> <span class="nam">scipy</span>
                    <span class="key">import</span> <span
                            class="nam">ndimage</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t20"><span
                        class="key">import</span> <span class="nam">copy</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t21"><span
                        class="key">from</span> <span
                        class="nam">scipy</span><span class="op">.</span><span
                        class="nam">ndimage</span><span
                        class="op">.</span><span class="nam">morphology</span>
                    <span class="key">import</span> <span class="nam">binary_closing</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t22"><span
                        class="key">import</span> <span
                        class="nam">zipfile</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t23"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t24"><span
                        class="key">from</span> <span
                        class="nam">settings</span> <span
                        class="key">import</span> <span
                        class="op">(</span><span
                        class="nam">RIVERS_TIF</span><span class="op">,</span>
                    <span class="nam">TEMP_REPROJECTED_TO_CUT</span><span
                            class="op">,</span> <span class="nam">TREE_CLASS_AREA</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t25"><span class="nam">SRTM_AREA_INTEREST_OVER</span><span
                        class="op">,</span> <span class="nam">HSHEDS_AREA_INTEREST_OVER</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t26"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t27"><span
                        class="key">def</span> <span
                        class="nam">array2raster</span><span
                        class="op">(</span><span
                        class="nam">rasterfn</span><span class="op">,</span>
                    <span class="nam">new_rasterfn</span><span
                            class="op">,</span> <span
                            class="nam">array</span><span
                            class="op">)</span><span class="op">:</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t28"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t29"><span class="str">    Save image contained in an array format to a tiff georeferenced file.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t30"><span class="str">    New image file will be located in new_rasterfn pathfile.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t31"><span class="str">    Georeference is taken from rasterfn file.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t32"><span class="str">    rasterfn and new_rasterfn must be strings with pathfile.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t33"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t34"><span
                        class="nam">raster</span> <span class="op">=</span>
                    <span class="nam">gdal</span><span class="op">.</span><span
                            class="nam">Open</span><span
                            class="op">(</span><span
                            class="nam">rasterfn</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t35"><span class="nam">geo_transform</span>
                    <span class="op">=</span> <span
                            class="nam">raster</span><span
                            class="op">.</span><span class="nam">GetGeoTransform</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t36"><span
                        class="nam">origin_x</span> <span class="op">=</span>
                    <span class="nam">geo_transform</span><span
                            class="op">[</span><span class="num">0</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t37"><span
                        class="nam">origin_y</span> <span class="op">=</span>
                    <span class="nam">geo_transform</span><span
                            class="op">[</span><span class="num">3</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t38"><span class="nam">pixel_width</span>
                    <span class="op">=</span> <span
                            class="nam">geo_transform</span><span
                            class="op">[</span><span class="num">1</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t39"><span class="nam">pixel_height</span>
                    <span class="op">=</span> <span
                            class="nam">geo_transform</span><span
                            class="op">[</span><span class="num">5</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t40"><span
                        class="nam">cols</span> <span class="op">=</span> <span
                        class="nam">raster</span><span class="op">.</span><span
                        class="nam">RasterXSize</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t41"><span
                        class="nam">rows</span> <span class="op">=</span> <span
                        class="nam">raster</span><span class="op">.</span><span
                        class="nam">RasterYSize</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t42"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t43"><span
                        class="nam">driver</span> <span class="op">=</span>
                    <span class="nam">gdal</span><span class="op">.</span><span
                            class="nam">GetDriverByName</span><span class="op">(</span><span
                            class="str">'GTiff'</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t44"><span class="nam">out_raster</span>
                    <span class="op">=</span> <span
                            class="nam">driver</span><span
                            class="op">.</span><span
                            class="nam">Create</span><span
                            class="op">(</span><span
                            class="nam">new_rasterfn</span><span
                            class="op">,</span> <span
                            class="nam">cols</span><span class="op">,</span>
                    <span class="nam">rows</span><span class="op">,</span>
                    <span class="num">1</span><span class="op">,</span> <span
                            class="nam">gdal</span><span
                            class="op">.</span><span
                            class="nam">GDT_Float32</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t45"><span class="nam">out_raster</span><span
                        class="op">.</span><span
                        class="nam">SetGeoTransform</span><span
                        class="op">(</span><span class="op">(</span><span
                        class="nam">origin_x</span><span class="op">,</span>
                    <span class="nam">pixel_width</span><span
                            class="op">,</span> <span class="num">0</span><span
                            class="op">,</span> <span
                            class="nam">origin_y</span><span
                            class="op">,</span> <span class="num">0</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t46"><span
                        class="nam">pixel_height</span><span
                        class="op">)</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t47"><span
                        class="nam">out_band</span> <span class="op">=</span>
                    <span class="nam">out_raster</span><span
                            class="op">.</span><span
                            class="nam">GetRasterBand</span><span
                            class="op">(</span><span class="num">1</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t48"><span
                        class="nam">out_band</span><span
                        class="op">.</span><span
                        class="nam">WriteArray</span><span
                        class="op">(</span><span class="nam">array</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t49"><span class="nam">out_raster_srs</span>
                    <span class="op">=</span> <span class="nam">osr</span><span
                            class="op">.</span><span class="nam">SpatialReference</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t50"><span class="nam">out_raster_srs</span><span
                        class="op">.</span><span
                        class="nam">ImportFromWkt</span><span
                        class="op">(</span><span class="nam">raster</span><span
                        class="op">.</span><span
                        class="nam">GetProjectionRef</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t51"><span class="nam">out_raster</span><span
                        class="op">.</span><span
                        class="nam">SetProjection</span><span
                        class="op">(</span><span
                        class="nam">out_raster_srs</span><span
                        class="op">.</span><span class="nam">ExportToWkt</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t52"><span
                        class="nam">out_band</span><span
                        class="op">.</span><span
                        class="nam">FlushCache</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t53"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t54"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t55"><span
                        class="key">def</span> <span class="nam">array2raster_simple</span><span
                        class="op">(</span><span
                        class="nam">new_rasterfn</span><span
                        class="op">,</span> <span class="nam">array</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t56"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t57"><span class="str">    Save an image 2-D array in a tiff file.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t58"><span class="str">    :param new_rasterfn: path file target</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t59"><span class="str">    :param array: 2-D array</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t60"><span
                        class="str">    :return: void</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t61"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t62"><span
                        class="nam">cols</span> <span class="op">=</span> <span
                        class="nam">array</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">1</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t63"><span
                        class="nam">rows</span> <span class="op">=</span> <span
                        class="nam">array</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">0</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t64"><span
                        class="nam">driver</span> <span class="op">=</span>
                    <span class="nam">gdal</span><span class="op">.</span><span
                            class="nam">GetDriverByName</span><span class="op">(</span><span
                            class="str">'GTiff'</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t65"><span class="nam">out_raster</span>
                    <span class="op">=</span> <span
                            class="nam">driver</span><span
                            class="op">.</span><span
                            class="nam">Create</span><span
                            class="op">(</span><span
                            class="nam">new_rasterfn</span><span
                            class="op">,</span> <span
                            class="nam">cols</span><span class="op">,</span>
                    <span class="nam">rows</span><span class="op">,</span>
                    <span class="num">1</span><span class="op">,</span> <span
                            class="nam">gdal</span><span
                            class="op">.</span><span
                            class="nam">GDT_Float32</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t66"><span
                        class="nam">outband</span> <span class="op">=</span>
                    <span class="nam">out_raster</span><span
                            class="op">.</span><span
                            class="nam">GetRasterBand</span><span
                            class="op">(</span><span class="num">1</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t67"><span
                        class="nam">outband</span><span
                        class="op">.</span><span
                        class="nam">WriteArray</span><span
                        class="op">(</span><span class="nam">array</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t68"><span
                        class="nam">outband</span><span
                        class="op">.</span><span
                        class="nam">FlushCache</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t69"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t70"><span
                        class="key">def</span> <span class="nam">majority_filter</span><span
                        class="op">(</span><span
                        class="nam">image_to_filter</span><span
                        class="op">,</span> <span
                        class="nam">window_size</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t71"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t72"><span class="str">    The value assigned to the center will be the most frequent value,</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t73"><span class="str">    contained in a windows of window_size x window_size</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t74"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t75"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t76"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">1</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t77"><span class="nam">filtered_image</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">ny</span><span class="op">,</span>
                    <span class="nam">nx</span><span class="op">)</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t78"><span class="nam">right_up_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t79"><span class="nam">left_down_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span>
                    <span class="op">+</span> <span class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t80"><span
                        class="key">for</span> <span class="nam">j</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">right_up_side</span><span
                        class="op">,</span> <span class="nam">ny</span> <span
                        class="op">-</span> <span
                        class="nam">left_down_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t81"><span
                        class="key">for</span> <span class="nam">i</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">left_down_side</span><span
                        class="op">,</span> <span class="nam">nx</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t82"><span class="nam">vertical_kernel</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t83"><span class="nam">j</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">j</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span
                        class="op">,</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t84"><span class="nam">i</span> <span
                        class="op">-</span> <span class="op">(</span><span
                        class="nam">right_up_side</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">)</span><span class="op">:</span> <span
                        class="nam">i</span> <span class="op">+</span> <span
                        class="op">(</span><span
                        class="nam">left_down_side</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t85"><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t86"><span class="nam">horizontal_kernel</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t87"><span class="nam">j</span> <span
                        class="op">-</span> <span class="op">(</span><span
                        class="nam">right_up_side</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">)</span><span class="op">:</span> <span
                        class="nam">j</span> <span class="op">+</span> <span
                        class="op">(</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t88"><span class="nam">left_down_side</span>
                    <span class="op">-</span> <span class="num">1</span><span
                            class="op">)</span><span class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t89"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t90"><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t91"><span class="nam">c</span>
                    <span class="op">=</span> <span
                            class="nam">Counter</span><span class="op">(</span><span
                            class="nam">vertical_kernel</span><span class="op">.</span><span
                            class="nam">flatten</span><span class="op">(</span><span
                            class="op">)</span> <span class="op">+</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t92"><span
                        class="nam">horizontal_kernel</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t93"><span
                        class="nam">value</span><span class="op">,</span> <span
                        class="nam">count</span> <span class="op">=</span>
                    <span class="nam">c</span><span class="op">.</span><span
                            class="nam">most_common</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="op">[</span><span class="num">0</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t94"><span
                        class="key">if</span> <span class="nam">count</span>
                    <span class="op">>=</span> <span class="op">(</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">window_size</span> <span
                            class="op">*</span> <span
                            class="nam">window_size</span><span
                            class="op">)</span> <span class="op">-</span> <span
                            class="num">1</span><span class="op">)</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="op">)</span><span class="op">:</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t95"><span class="nam">filtered_image</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span><span
                        class="op">]</span> <span class="op">=</span> <span
                        class="nam">value</span> <span class="op">/</span>
                    <span class="num">2</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t96"><span
                        class="key">return</span> <span class="nam">filtered_image</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t97"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t98"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t99"><span
                        class="key">def</span> <span
                        class="nam">expand_filter</span><span
                        class="op">(</span><span
                        class="nam">image_to_expand</span><span
                        class="op">,</span> <span
                        class="nam">window_size</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t100"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t101"><span class="str">    The value assigned to the center will be 1 if at least one pixel</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t102"><span class="str">    inside the kernel is 1</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t103"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t104"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">image_to_expand</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t105"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">image_to_expand</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">1</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t106"><span class="nam">expanded_image</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">ny</span><span class="op">,</span>
                    <span class="nam">nx</span><span class="op">)</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t107"><span class="nam">right_up_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t108"><span class="nam">left_down_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span>
                    <span class="op">+</span> <span class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t109"><span
                        class="nam">s</span> <span class="op">=</span> <span
                        class="op">{</span><span class="num">0</span><span
                        class="op">}</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t110"><span
                        class="key">for</span> <span class="nam">j</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">right_up_side</span><span
                        class="op">,</span> <span class="nam">ny</span> <span
                        class="op">-</span> <span
                        class="nam">left_down_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t111"><span
                        class="key">for</span> <span class="nam">i</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">left_down_side</span><span
                        class="op">,</span> <span class="nam">nx</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t112"><span class="nam">vertical_kernel</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_expand</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t113"><span class="nam">j</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">j</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span
                        class="op">,</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t114"><span class="nam">i</span> <span
                        class="op">-</span> <span class="op">(</span><span
                        class="nam">right_up_side</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">)</span><span class="op">:</span> <span
                        class="nam">i</span> <span class="op">+</span> <span
                        class="op">(</span><span
                        class="nam">left_down_side</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t115"><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t116"><span class="nam">horizontal_kernel</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_expand</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t117"><span class="nam">j</span> <span
                        class="op">-</span> <span class="op">(</span><span
                        class="nam">right_up_side</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">)</span><span class="op">:</span> <span
                        class="nam">j</span> <span class="op">+</span> <span
                        class="op">(</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t118"><span
                        class="nam">left_down_side</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">)</span><span class="op">,</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t119"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t120"><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t121"><span
                        class="nam">v</span> <span class="op">=</span> <span
                        class="nam">set</span><span class="op">(</span><span
                        class="nam">vertical_kernel</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t122"><span
                        class="nam">h</span> <span class="op">=</span> <span
                        class="nam">set</span><span class="op">(</span><span
                        class="nam">horizontal_kernel</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t123"><span
                        class="nam">t</span> <span class="op">=</span> <span
                        class="nam">v</span> <span class="op">|</span> <span
                        class="nam">h</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t124"><span
                        class="key">if</span> <span class="nam">len</span><span
                        class="op">(</span><span class="nam">t</span> <span
                        class="op">-</span> <span class="nam">s</span><span
                        class="op">)</span> <span class="op">></span> <span
                        class="num">0</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t125"><span class="nam">expanded_image</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span><span
                        class="op">]</span> <span class="op">=</span> <span
                        class="num">1</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t126"><span
                        class="key">return</span> <span class="nam">expanded_image</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t127"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t128"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t129"><span
                        class="key">def</span> <span
                        class="nam">route_rivers</span><span
                        class="op">(</span><span class="nam">dem_in</span><span
                        class="op">,</span> <span class="nam">maskRivers</span><span
                        class="op">,</span> <span
                        class="nam">window_size</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t130"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t131"><span class="str">    Apply homogeneity to canyons. Specific defined for images with flow stream.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t132"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t133"><span
                        class="nam">dem</span> <span class="op">=</span> <span
                        class="nam">copy</span><span class="op">.</span><span
                        class="nam">deepcopy</span><span
                        class="op">(</span><span class="nam">dem_in</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t134"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">dem</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">0</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t135"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">dem</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">1</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t136"><span
                        class="nam">indices</span> <span class="op">=</span>
                    <span class="nam">np</span><span class="op">.</span><span
                            class="nam">nonzero</span><span class="op">(</span><span
                            class="nam">maskRivers</span> <span
                            class="op">></span> <span
                            class="num">0.0</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t137"><span class="nam">rivers_enrouted</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">ny</span><span class="op">,</span>
                    <span class="nam">nx</span><span class="op">)</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t138"><span class="nam">right_up_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t139"><span class="nam">left_down_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span>
                    <span class="op">+</span> <span class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t140"><span class="nam">neighbors</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">window_size</span><span
                            class="op">,</span> <span
                            class="nam">window_size</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t141"><span
                        class="key">for</span> <span class="nam">x</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">len</span><span class="op">(</span><span
                        class="nam">indices</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="op">)</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t142"><span
                        class="nam">j</span> <span class="op">=</span> <span
                        class="nam">indices</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="op">[</span><span
                        class="nam">x</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t143"><span
                        class="nam">i</span> <span class="op">=</span> <span
                        class="nam">indices</span><span
                        class="op">[</span><span class="num">1</span><span
                        class="op">]</span><span class="op">[</span><span
                        class="nam">x</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t144"><span
                        class="key">if</span> <span class="op">(</span><span
                        class="nam">left_down_side</span> <span
                        class="op">&lt;</span> <span class="nam">i</span> <span
                        class="op">&lt;</span> <span class="nam">nx</span>
                    <span class="op">-</span> <span class="op">(</span><span
                            class="nam">right_up_side</span> <span
                            class="op">-</span> <span class="num">1</span><span
                            class="op">)</span> <span
                            class="key">and</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t145"><span
                        class="nam">left_down_side</span> <span
                        class="op">&lt;</span> <span class="nam">j</span> <span
                        class="op">&lt;</span> <span class="nam">ny</span>
                    <span class="op">-</span> <span class="op">(</span><span
                            class="nam">right_up_side</span> <span
                            class="op">-</span> <span class="num">1</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="op">:</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t146"><span class="nam">neighbors</span>
                    <span class="op">=</span> <span class="nam">dem</span><span
                            class="op">[</span><span class="nam">j</span> <span
                            class="op">-</span> <span class="op">(</span><span
                            class="nam">window_size</span> <span
                            class="op">-</span> <span class="num">2</span><span
                            class="op">)</span><span class="op">:</span> <span
                            class="nam">j</span> <span class="op">+</span>
                    <span class="op">(</span><span
                            class="nam">window_size</span> <span
                            class="op">-</span> <span class="num">1</span><span
                            class="op">)</span><span class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t147"><span class="nam">i</span> <span
                        class="op">-</span> <span class="op">(</span><span
                        class="nam">window_size</span> <span
                        class="op">-</span> <span class="num">2</span><span
                        class="op">)</span><span class="op">:</span> <span
                        class="nam">i</span> <span class="op">+</span> <span
                        class="op">(</span><span class="nam">window_size</span>
                    <span class="op">-</span> <span class="num">1</span><span
                            class="op">)</span><span class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t148"><span class="nam">neighbors_flat</span>
                    <span class="op">=</span> <span
                            class="nam">neighbors</span><span
                            class="op">.</span><span class="nam">flatten</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t149"><span class="nam">neighbor_min</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">amin</span><span
                            class="op">(</span><span
                            class="nam">neighbors_flat</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t150"><span class="nam">indices_min</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span class="nam">nonzero</span><span
                            class="op">(</span><span
                            class="nam">neighbors</span> <span
                            class="op">==</span> <span
                            class="nam">neighbor_min</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t151"><span
                        class="key">for</span> <span class="nam">z</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">len</span><span class="op">(</span><span
                        class="nam">indices_min</span><span class="op">[</span><span
                        class="num">0</span><span class="op">]</span><span
                        class="op">)</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t152"><span
                        class="nam">min_j</span> <span class="op">=</span>
                    <span class="nam">indices_min</span><span
                            class="op">[</span><span class="num">0</span><span
                            class="op">]</span><span class="op">[</span><span
                            class="nam">z</span><span class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t153"><span
                        class="nam">min_i</span> <span class="op">=</span>
                    <span class="nam">indices_min</span><span
                            class="op">[</span><span class="num">1</span><span
                            class="op">]</span><span class="op">[</span><span
                            class="nam">z</span><span class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t154"><span class="nam">min_j_index</span>
                    <span class="op">=</span> <span class="nam">j</span> <span
                            class="op">-</span> <span class="op">(</span><span
                            class="nam">window_size</span> <span
                            class="op">-</span> <span class="num">2</span><span
                            class="op">)</span> <span class="op">+</span> <span
                            class="nam">min_j</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t155"><span class="nam">min_i_index</span>
                    <span class="op">=</span> <span class="nam">i</span> <span
                            class="op">-</span> <span class="op">(</span><span
                            class="nam">window_size</span> <span
                            class="op">-</span> <span class="num">2</span><span
                            class="op">)</span> <span class="op">+</span> <span
                            class="nam">min_i</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t156"><span class="nam">rivers_enrouted</span><span
                        class="op">[</span><span class="nam">min_j_index</span><span
                        class="op">,</span> <span
                        class="nam">min_i_index</span><span class="op">]</span>
                    <span class="op">=</span> <span class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t157"><span
                        class="nam">dem</span><span class="op">[</span><span
                        class="nam">min_j_index</span><span class="op">,</span>
                    <span class="nam">min_i_index</span><span
                            class="op">]</span> <span class="op">=</span> <span
                            class="num">10000</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t158"><span
                        class="key">return</span> <span class="nam">rivers_enrouted</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t159"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t160"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t161"><span
                        class="key">def</span> <span class="nam">quadratic_filter</span><span
                        class="op">(</span><span class="nam">z</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t162"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t163"><span class="str">    Smoothness filter: Apply a quadratic filter of smoothness</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t164"><span class="str">    :param z: dem image</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t165"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t166"><span
                        class="nam">n</span> <span class="op">=</span> <span
                        class="num">15</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t167"><span
                        class="nam">xx</span><span class="op">,</span> <span
                        class="nam">yy</span> <span class="op">=</span> <span
                        class="nam">np</span><span class="op">.</span><span
                        class="nam">meshgrid</span><span
                        class="op">(</span><span class="nam">np</span><span
                        class="op">.</span><span
                        class="nam">linspace</span><span
                        class="op">(</span><span class="op">-</span><span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span> <span class="op">+</span> <span
                        class="num">1</span><span class="op">,</span> <span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span><span class="op">,</span> <span
                        class="nam">n</span><span class="op">)</span><span
                        class="op">,</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t168"><span class="nam">np</span><span
                        class="op">.</span><span
                        class="nam">linspace</span><span
                        class="op">(</span><span class="op">-</span><span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span> <span class="op">+</span> <span
                        class="num">1</span><span class="op">,</span> <span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span><span class="op">,</span> <span
                        class="nam">n</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t169"><span
                        class="nam">r0</span> <span class="op">=</span> <span
                        class="nam">n</span> <span class="op">**</span> <span
                        class="num">2</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t170"><span
                        class="nam">r1</span> <span class="op">=</span> <span
                        class="op">(</span><span class="nam">xx</span> <span
                        class="op">*</span> <span class="nam">xx</span><span
                        class="op">)</span><span class="op">.</span><span
                        class="nam">sum</span><span class="op">(</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t171"><span
                        class="nam">r2</span> <span class="op">=</span> <span
                        class="op">(</span><span class="nam">xx</span> <span
                        class="op">*</span> <span class="nam">xx</span> <span
                        class="op">*</span> <span class="nam">xx</span> <span
                        class="op">*</span> <span class="nam">xx</span><span
                        class="op">)</span><span class="op">.</span><span
                        class="nam">sum</span><span class="op">(</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t172"><span
                        class="nam">r3</span> <span class="op">=</span> <span
                        class="op">(</span><span class="nam">xx</span> <span
                        class="op">*</span> <span class="nam">xx</span> <span
                        class="op">*</span> <span class="nam">yy</span> <span
                        class="op">*</span> <span class="nam">yy</span><span
                        class="op">)</span><span class="op">.</span><span
                        class="nam">sum</span><span class="op">(</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t173"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">z</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">0</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t174"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">z</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">1</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t175"><span
                        class="nam">zp</span> <span class="op">=</span> <span
                        class="nam">z</span><span class="op">.</span><span
                        class="nam">copy</span><span class="op">(</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t176"><span
                        class="key">for</span> <span class="nam">i</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span><span class="op">,</span> <span
                        class="nam">nx</span> <span class="op">-</span> <span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t177"><span
                        class="key">for</span> <span class="nam">j</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span><span class="op">,</span> <span
                        class="nam">ny</span> <span class="op">-</span> <span
                        class="nam">n</span> <span class="op">/</span> <span
                        class="num">2</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t178"><span
                        class="nam">z_aux</span> <span class="op">=</span>
                    <span class="nam">z</span><span class="op">[</span><span
                            class="nam">j</span> <span class="op">-</span>
                    <span class="nam">n</span> <span class="op">/</span> <span
                            class="num">2</span><span class="op">:</span><span
                            class="nam">j</span> <span class="op">+</span>
                    <span class="nam">n</span> <span class="op">/</span> <span
                            class="num">2</span> <span class="op">+</span>
                    <span class="num">1</span><span class="op">,</span> <span
                            class="nam">i</span> <span class="op">-</span>
                    <span class="nam">n</span> <span class="op">/</span> <span
                            class="num">2</span><span class="op">:</span><span
                            class="nam">i</span> <span class="op">+</span>
                    <span class="nam">n</span> <span class="op">/</span> <span
                            class="num">2</span> <span class="op">+</span>
                    <span class="num">1</span><span class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t179"><span
                        class="nam">s1</span> <span class="op">=</span> <span
                        class="nam">z_aux</span><span class="op">.</span><span
                        class="nam">sum</span><span class="op">(</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t180"><span
                        class="nam">s2</span> <span class="op">=</span> <span
                        class="op">(</span><span class="nam">z_aux</span> <span
                        class="op">*</span> <span class="nam">xx</span> <span
                        class="op">*</span> <span class="nam">xx</span><span
                        class="op">)</span><span class="op">.</span><span
                        class="nam">sum</span><span class="op">(</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t181"><span
                        class="nam">s3</span> <span class="op">=</span> <span
                        class="op">(</span><span class="nam">z_aux</span> <span
                        class="op">*</span> <span class="nam">yy</span> <span
                        class="op">*</span> <span class="nam">yy</span><span
                        class="op">)</span><span class="op">.</span><span
                        class="nam">sum</span><span class="op">(</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t182"><span
                        class="nam">zp</span><span class="op">[</span><span
                        class="nam">j</span><span class="op">,</span> <span
                        class="nam">i</span><span class="op">]</span> <span
                        class="op">=</span> <span class="op">(</span><span
                        class="op">(</span><span class="nam">s2</span> <span
                        class="op">+</span> <span class="nam">s3</span><span
                        class="op">)</span> <span class="op">*</span> <span
                        class="nam">r1</span> <span class="op">-</span> <span
                        class="nam">s1</span> <span class="op">*</span> <span
                        class="op">(</span><span class="nam">r2</span> <span
                        class="op">+</span> <span class="nam">r3</span><span
                        class="op">)</span><span class="op">)</span> <span
                        class="op">/</span> <span class="op">(</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t183"><span class="num">2</span> <span
                        class="op">*</span> <span class="nam">r1</span> <span
                        class="op">**</span> <span class="num">2</span> <span
                        class="op">-</span> <span class="nam">r0</span> <span
                        class="op">*</span> <span class="op">(</span><span
                        class="nam">r2</span> <span class="op">+</span> <span
                        class="nam">r3</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t184"><span class="nam">dem_quadratic</span>
                    <span class="op">=</span> <span class="nam">zp</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t185"><span
                        class="key">return</span> <span class="nam">dem_quadratic</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t186"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t187"><span
                        class="key">def</span> <span class="nam">correct_nan_values</span><span
                        class="op">(</span><span class="nam">dem</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t188"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t189"><span class="str">    Correct values lower than zero, generally with extremely lowest values.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t190"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t191"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">dem</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">0</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t192"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">dem</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">1</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t193"><span
                        class="nam">indices</span> <span class="op">=</span>
                    <span class="nam">np</span><span class="op">.</span><span
                            class="nam">nonzero</span><span class="op">(</span><span
                            class="nam">dem</span> <span class="op">&lt;</span>
                    <span class="num">0.0</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t194"><span class="nam">dem_corrected_nan</span>
                    <span class="op">=</span> <span class="nam">dem</span><span
                            class="op">.</span><span
                            class="nam">copy</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t195"><span
                        class="key">for</span> <span class="nam">x</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">len</span><span class="op">(</span><span
                        class="nam">indices</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="op">)</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t196"><span
                        class="nam">j</span> <span class="op">=</span> <span
                        class="nam">indices</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="op">[</span><span
                        class="nam">x</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t197"><span
                        class="nam">i</span> <span class="op">=</span> <span
                        class="nam">indices</span><span
                        class="op">[</span><span class="num">1</span><span
                        class="op">]</span><span class="op">[</span><span
                        class="nam">x</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t198"><span
                        class="key">if</span> <span class="nam">i</span> <span
                        class="op">!=</span> <span class="num">0</span> <span
                        class="key">and</span> <span class="nam">j</span> <span
                        class="op">!=</span> <span class="num">0</span> <span
                        class="key">and</span> <span class="nam">i</span> <span
                        class="op">!=</span> <span class="nam">nx</span> <span
                        class="op">-</span> <span class="num">1</span> <span
                        class="key">and</span> <span class="nam">j</span> <span
                        class="op">!=</span> <span class="nam">ny</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t199"><span class="nam">neighbors</span>
                    <span class="op">=</span> <span class="nam">dem</span><span
                            class="op">[</span><span class="nam">j</span> <span
                            class="op">-</span> <span class="num">1</span><span
                            class="op">,</span> <span class="nam">i</span>
                    <span class="op">-</span> <span class="num">1</span><span
                            class="op">:</span> <span class="nam">i</span>
                    <span class="op">+</span> <span class="num">2</span><span
                            class="op">]</span><span class="op">.</span><span
                            class="nam">flatten</span><span class="op">(</span><span
                            class="op">)</span><span class="op">.</span><span
                            class="nam">tolist</span><span
                            class="op">(</span><span class="op">)</span> <span
                            class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t200"><span class="op">+</span> <span
                        class="nam">dem</span><span class="op">[</span><span
                        class="nam">j</span> <span class="op">+</span> <span
                        class="num">1</span><span class="op">,</span> <span
                        class="nam">i</span> <span class="op">-</span> <span
                        class="num">1</span><span class="op">:</span> <span
                        class="nam">i</span> <span class="op">+</span> <span
                        class="num">2</span><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span> <span
                        class="xx">\</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t201"><span class="op">+</span> <span
                        class="op">[</span><span class="nam">dem</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span> <span
                        class="op">-</span> <span class="num">1</span><span
                        class="op">]</span><span class="op">]</span> <span
                        class="op">+</span> <span class="op">[</span><span
                        class="nam">dem</span><span class="op">[</span><span
                        class="nam">j</span><span class="op">,</span> <span
                        class="nam">i</span> <span class="op">+</span> <span
                        class="num">1</span><span class="op">]</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t202"><span class="nam">neighbors_array</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">array</span><span
                            class="op">(</span><span
                            class="nam">neighbors</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t203"><span class="nam">greater_than_zero</span>
                    <span class="op">=</span> <span class="op">(</span><span
                            class="nam">neighbors_array</span> <span
                            class="op">></span> <span class="num">0</span><span
                            class="op">)</span> <span class="op">*</span> <span
                            class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t204"><span
                        class="nam">c</span> <span class="op">=</span> <span
                        class="nam">Counter</span><span
                        class="op">(</span><span
                        class="nam">greater_than_zero</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t205"><span
                        class="nam">value</span><span class="op">,</span> <span
                        class="nam">count</span> <span class="op">=</span>
                    <span class="nam">c</span><span class="op">.</span><span
                            class="nam">most_common</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="op">[</span><span class="num">0</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t206"><span
                        class="nam">n</span> <span class="op">=</span> <span
                        class="op">(</span><span class="op">(</span><span
                        class="nam">value</span> <span class="op">==</span>
                    <span class="num">0</span><span class="op">)</span> <span
                            class="op">*</span> <span class="num">1</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t207"><span class="nam">sum_neighbors</span>
                    <span class="op">=</span> <span class="nam">sum</span><span
                            class="op">(</span><span
                            class="nam">neighbors</span> <span
                            class="op">*</span> <span
                            class="nam">np</span><span class="op">.</span><span
                            class="nam">absolute</span><span
                            class="op">(</span><span class="nam">n</span> <span
                            class="op">-</span> <span class="nam">greater_than_zero</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t208"><span class="nam">mean_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">sum_neighbors</span> <span
                            class="op">/</span> <span
                            class="nam">count</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t209"><span class="nam">dem_corrected_nan</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span><span
                        class="op">]</span> <span class="op">=</span> <span
                        class="nam">mean_neighbors</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t210"><span
                        class="key">return</span> <span class="nam">dem_corrected_nan</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t211"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t212"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t213"><span
                        class="key">def</span> <span class="nam">filter_isolated_pixels</span><span
                        class="op">(</span><span
                        class="nam">image_to_filter</span><span
                        class="op">,</span> <span
                        class="nam">window_size</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t214"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t215"><span class="str">    Remove isolated pixels detected to be part of a mask.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t216"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t217"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t218"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">1</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t219"><span class="nam">filtered_image</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">ny</span><span class="op">,</span>
                    <span class="nam">nx</span><span class="op">)</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t220"><span class="nam">right_up_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t221"><span class="nam">left_down_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span>
                    <span class="op">+</span> <span class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t222"><span
                        class="nam">margin</span> <span class="op">=</span>
                    <span class="num">0</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t223"><span
                        class="key">for</span> <span class="nam">j</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">right_up_side</span><span
                        class="op">,</span> <span class="nam">ny</span> <span
                        class="op">-</span> <span
                        class="nam">left_down_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t224"><span
                        class="key">for</span> <span class="nam">i</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="nam">left_down_side</span><span
                        class="op">,</span> <span class="nam">nx</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t225"><span
                        class="key">if</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span><span
                        class="op">]</span> <span class="op">==</span> <span
                        class="num">1</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t226"><span class="nam">above_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t227"><span class="nam">j</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">j</span> <span
                        class="op">-</span> <span
                        class="nam">margin</span><span class="op">,</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t228"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t229"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t230"><span class="nam">below_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t231"><span class="nam">j</span> <span
                        class="op">+</span> <span class="num">1</span> <span
                        class="op">+</span> <span
                        class="nam">margin</span><span class="op">:</span>
                    <span class="nam">j</span> <span class="op">+</span> <span
                            class="nam">left_down_side</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t232"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t233"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t234"><span class="nam">right_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t235"><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">margin</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t236"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t237"><span class="nam">left_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t238"><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span> <span
                        class="op">+</span> <span class="num">1</span> <span
                        class="op">+</span> <span
                        class="nam">margin</span><span class="op">:</span>
                    <span class="nam">i</span> <span class="op">+</span> <span
                            class="nam">left_down_side</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t239"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t240"><span class="nam">neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">above_neighbors</span> <span
                            class="op">+</span> <span class="nam">below_neighbors</span>
                    <span class="xx">\</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t241"><span class="op">+</span> <span
                        class="nam">right_neighbors</span> <span
                        class="op">+</span> <span
                        class="nam">left_neighbors</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t242"><span class="nam">sum_neighbors</span>
                    <span class="op">=</span> <span class="nam">sum</span><span
                            class="op">(</span><span
                            class="nam">neighbors</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t243"><span class="nam">filtered_image</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span><span
                        class="op">]</span> <span class="op">=</span> <span
                        class="op">(</span><span
                        class="nam">sum_neighbors</span> <span
                        class="op">></span> <span class="num">0</span><span
                        class="op">)</span> <span class="op">*</span> <span
                        class="num">1</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t244"><span
                        class="key">return</span> <span class="nam">filtered_image</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t245"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t246"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t247"><span
                        class="key">def</span> <span
                        class="nam">filter_blanks</span><span
                        class="op">(</span><span
                        class="nam">image_to_filter</span><span
                        class="op">,</span> <span
                        class="nam">window_size</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t248"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t249"><span class="str">    Define the filter to detect blanks in a fourier transform image.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t250"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t251"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t252"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">1</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t253"><span class="nam">filtered_image</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">ny</span><span class="op">,</span>
                    <span class="nam">nx</span><span class="op">)</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t254"><span class="nam">right_up_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t255"><span class="nam">left_down_side</span>
                    <span class="op">=</span> <span
                            class="nam">window_size</span> <span
                            class="op">/</span> <span class="num">2</span>
                    <span class="op">+</span> <span class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t256"><span
                        class="nam">margin</span> <span class="op">=</span>
                    <span class="num">5</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t257"><span
                        class="key">for</span> <span class="nam">j</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="num">0</span><span class="op">,</span> <span
                        class="nam">ny</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t258"><span
                        class="key">for</span> <span class="nam">i</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="num">0</span><span class="op">,</span> <span
                        class="nam">nx</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t259"><span
                        class="key">if</span> <span class="nam">j</span> <span
                        class="op">&lt;</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t260"><span class="nam">above_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t261"><span class="num">0</span><span
                        class="op">:</span> <span class="nam">j</span><span
                        class="op">,</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t262"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t263"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t264"><span class="key">else</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t265"><span class="nam">above_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t266"><span class="nam">j</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">j</span> <span
                        class="op">-</span> <span
                        class="nam">margin</span><span class="op">,</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t267"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span> <span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t268"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t269"><span
                        class="key">if</span> <span class="nam">j</span> <span
                        class="op">></span> <span class="op">(</span><span
                        class="nam">ny</span> <span class="op">-</span> <span
                        class="nam">left_down_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t270"><span class="nam">below_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t271"><span class="nam">j</span> <span
                        class="op">+</span> <span class="num">1</span><span
                        class="op">:</span> <span class="nam">ny</span><span
                        class="op">,</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t272"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span><span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t273"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t274"><span class="key">else</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t275"><span class="nam">below_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t276"><span class="nam">j</span> <span
                        class="op">+</span> <span class="num">1</span> <span
                        class="op">+</span> <span
                        class="nam">margin</span><span class="op">:</span><span
                        class="nam">j</span> <span class="op">+</span> <span
                        class="nam">left_down_side</span><span
                        class="op">,</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t277"><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span><span class="nam">i</span> <span
                        class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t278"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t279"><span
                        class="key">if</span> <span class="nam">i</span> <span
                        class="op">></span> <span class="op">(</span><span
                        class="nam">nx</span> <span class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t280"><span class="nam">right_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t281"><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span> <span
                        class="op">+</span> <span class="num">1</span><span
                        class="op">:</span><span class="nam">nx</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t282"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t283"><span class="key">else</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t284"><span class="nam">right_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t285"><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span> <span
                        class="op">+</span> <span class="num">1</span> <span
                        class="op">+</span> <span
                        class="nam">margin</span><span class="op">:</span><span
                        class="nam">i</span> <span class="op">+</span> <span
                        class="nam">left_down_side</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t286"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t287"><span
                        class="key">if</span> <span class="nam">i</span> <span
                        class="op">&lt;</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t288"><span class="nam">left_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="nam">j</span><span class="op">,</span> <span
                            class="num">0</span><span class="op">:</span><span
                            class="nam">i</span><span class="op">]</span><span
                            class="op">.</span><span class="nam">flatten</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="op">.</span><span
                            class="nam">tolist</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t289"><span class="key">else</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t290"><span class="nam">left_neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span><span class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t291"><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">right_up_side</span><span
                        class="op">:</span><span class="nam">i</span> <span
                        class="op">-</span> <span
                        class="nam">margin</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t292"><span class="op">]</span><span
                        class="op">.</span><span
                        class="nam">flatten</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">tolist</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t293"><span class="nam">neighbors</span>
                    <span class="op">=</span> <span
                            class="nam">above_neighbors</span> <span
                            class="op">+</span> <span class="nam">below_neighbors</span>
                    <span class="op">+</span> <span
                            class="nam">right_neighbors</span> <span
                            class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t294"><span class="op">+</span> <span
                        class="nam">left_neighbors</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t295"><span class="nam">mean_neighbor</span>
                    <span class="op">=</span> <span class="nam">sum</span><span
                            class="op">(</span><span
                            class="nam">neighbors</span><span
                            class="op">)</span> <span class="op">/</span> <span
                            class="nam">len</span><span
                            class="op">(</span><span
                            class="nam">neighbors</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t296"><span
                        class="key">if</span> <span
                        class="nam">image_to_filter</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span><span
                        class="op">]</span> <span class="op">></span> <span
                        class="op">(</span><span class="num">4</span> <span
                        class="op">*</span> <span
                        class="nam">mean_neighbor</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t297"><span class="nam">filtered_image</span><span
                        class="op">[</span><span class="nam">j</span><span
                        class="op">,</span> <span class="nam">i</span><span
                        class="op">]</span> <span class="op">=</span> <span
                        class="nam">mean_neighbor</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t298"><span class="nam">mask_not_filtered</span>
                    <span class="op">=</span> <span class="op">(</span><span
                            class="nam">filtered_image</span> <span class="op">==</span>
                    <span class="num">0</span><span class="op">)</span> <span
                            class="op">*</span> <span
                            class="num">1.0</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t299"><span class="nam">mask_filtered</span>
                    <span class="op">=</span> <span class="num">1</span> <span
                            class="op">-</span> <span class="nam">mask_not_filtered</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t300"><span class="nam">image_modified</span>
                    <span class="op">=</span> <span
                            class="nam">image_to_filter</span> <span
                            class="op">*</span> <span class="nam">mask_not_filtered</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t301"><span
                        class="key">return</span> <span class="nam">mask_filtered</span><span
                        class="op">,</span> <span
                        class="nam">image_modified</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t302"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t303"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t304"><span
                        class="key">def</span> <span class="nam">get_mask_fourier</span><span
                        class="op">(</span><span
                        class="nam">quarter_fourier</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t305"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t306"><span class="str">    Perform iterations of filter blanks functions and produce a final mask</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t307"><span class="str">    with blanks of fourier transform.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t308"><span class="str">    :param quarter_fourier: fourier transform image.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t309"><span class="str">    :return: mask with detected blanks</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t310"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t311"><span class="nam">quarter_ny</span>
                    <span class="op">=</span> <span
                            class="nam">quarter_fourier</span><span class="op">.</span><span
                            class="nam">shape</span><span
                            class="op">[</span><span class="num">0</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t312"><span class="nam">quarter_nx</span>
                    <span class="op">=</span> <span
                            class="nam">quarter_fourier</span><span class="op">.</span><span
                            class="nam">shape</span><span
                            class="op">[</span><span class="num">1</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t313"><span class="nam">final_mask_image</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">quarter_ny</span><span
                            class="op">,</span> <span
                            class="nam">quarter_nx</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t314"><span class="com"># TODO: Eliminar variables innecesarias</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t315"><span class="nam">image_modified</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">quarter_ny</span><span
                            class="op">,</span> <span
                            class="nam">quarter_nx</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t316"><span
                        class="key">for</span> <span class="nam">i</span> <span
                        class="key">in</span> <span
                        class="nam">range</span><span class="op">(</span><span
                        class="num">0</span><span class="op">,</span> <span
                        class="num">2</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t317"><span class="op">(</span><span
                        class="nam">filtered_blank_image</span><span
                        class="op">,</span> <span
                        class="nam">image_modified</span><span
                        class="op">)</span> <span class="op">=</span> <span
                        class="xx">\</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t318"><span class="nam">filter_blanks</span><span
                        class="op">(</span><span
                        class="nam">quarter_fourier</span><span
                        class="op">,</span> <span class="num">55</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t319"><span class="nam">final_mask_image</span>
                    <span class="op">=</span> <span class="nam">final_mask_image</span>
                    <span class="op">+</span> <span class="nam">filtered_blank_image</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t320"><span class="nam">quarter_fourier</span>
                    <span class="op">=</span> <span
                            class="nam">image_modified</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t321"><span class="nam">final_mask_im_without_pts</span>
                    <span class="op">=</span> <span class="nam">filter_isolated_pixels</span><span
                            class="op">(</span><span class="nam">final_mask_image</span><span
                            class="op">,</span> <span class="num">3</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t322"><span class="nam">final_mask</span>
                    <span class="op">=</span> <span
                            class="nam">expand_filter</span><span
                            class="op">(</span><span class="nam">final_mask_im_without_pts</span><span
                            class="op">,</span> <span
                            class="num">13</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t323"><span
                        class="key">return</span> <span
                        class="nam">final_mask</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t324"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t325"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t326"><span
                        class="key">def</span> <span class="nam">detect_apply_fourier</span><span
                        class="op">(</span><span
                        class="nam">image_to_correct</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t327"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t328"><span class="str">    Detect blanks in Fourier transform image, create mask and apply fourier.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t329"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t330"><span class="nam">image_to_correct_array</span>
                    <span class="op">=</span> <span
                            class="nam">gdal</span><span
                            class="op">.</span><span
                            class="nam">Open</span><span
                            class="op">(</span><span class="nam">image_to_correct</span><span
                            class="op">)</span><span class="op">.</span><span
                            class="nam">ReadAsArray</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t331"><span class="nam">fourier_transform</span>
                    <span class="op">=</span> <span
                            class="nam">fftpack</span><span class="op">.</span><span
                            class="nam">fft2</span><span
                            class="op">(</span><span class="nam">image_to_correct_array</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t332"><span class="nam">fourier_transform_shifted</span>
                    <span class="op">=</span> <span
                            class="nam">fftpack</span><span class="op">.</span><span
                            class="nam">fftshift</span><span
                            class="op">(</span><span class="nam">fourier_transform</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t333"><span class="nam">fft_transform_abs</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">abs</span><span
                            class="op">(</span><span class="nam">fourier_transform_shifted</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t334"><span
                        class="nam">nx</span> <span class="op">=</span> <span
                        class="nam">fft_transform_abs</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">1</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t335"><span
                        class="nam">ny</span> <span class="op">=</span> <span
                        class="nam">fft_transform_abs</span><span
                        class="op">.</span><span class="nam">shape</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t336"><span
                        class="nam">x_odd</span> <span class="op">=</span>
                    <span class="nam">nx</span> <span class="op">&amp;</span>
                    <span class="num">1</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t337"><span
                        class="nam">y_odd</span> <span class="op">=</span>
                    <span class="nam">ny</span> <span class="op">&amp;</span>
                    <span class="num">1</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t338"><span class="nam">middle_x</span>
                    <span class="op">=</span> <span class="nam">nx</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t339"><span class="nam">middle_y</span>
                    <span class="op">=</span> <span class="nam">ny</span> <span
                            class="op">/</span> <span class="num">2</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t340"><span
                        class="nam">margin</span> <span class="op">=</span>
                    <span class="num">10</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t341"><span class="nam">fst_quarter_fourier</span>
                    <span class="op">=</span> <span class="nam">fft_transform_abs</span><span
                            class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t342"><span class="num">0</span><span
                        class="op">:</span><span class="nam">middle_y</span>
                    <span class="op">-</span> <span
                            class="nam">margin</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t343"><span class="num">0</span><span
                        class="op">:</span><span class="nam">middle_x</span>
                    <span class="op">-</span> <span
                            class="nam">margin</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t344"><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t345"><span class="nam">snd_quarter_fourier</span>
                    <span class="op">=</span> <span class="nam">fft_transform_abs</span><span
                            class="op">[</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t346"><span class="num">0</span><span
                        class="op">:</span><span class="nam">middle_y</span>
                    <span class="op">-</span> <span
                            class="nam">margin</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t347"><span class="nam">middle_x</span>
                    <span class="op">+</span> <span class="nam">margin</span>
                    <span class="op">+</span> <span
                            class="nam">x_odd</span><span
                            class="op">:</span><span class="nam">nx</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t348"><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t349"><span
                        class="nam">p</span> <span class="op">=</span> <span
                        class="nam">Pool</span><span class="op">(</span><span
                        class="num">2</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t350"><span class="nam">masks_fourier</span>
                    <span class="op">=</span> <span class="nam">p</span><span
                            class="op">.</span><span
                            class="nam">map</span><span
                            class="op">(</span><span class="nam">get_mask_fourier</span><span
                            class="op">,</span> <span class="op">[</span><span
                            class="nam">fst_quarter_fourier</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t351"><span
                        class="nam">snd_quarter_fourier</span><span class="op">]</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t352"><span class="nam">first_quarter_mask</span>
                    <span class="op">=</span> <span
                            class="nam">masks_fourier</span><span
                            class="op">[</span><span class="num">0</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t353"><span class="nam">second_quarter_mask</span>
                    <span class="op">=</span> <span
                            class="nam">masks_fourier</span><span
                            class="op">[</span><span class="num">1</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t354"><span class="nam">fst_complete_quarter</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">middle_y</span><span
                            class="op">,</span> <span
                            class="nam">middle_x</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t355"><span class="nam">snd_complete_quarter</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="nam">middle_y</span><span
                            class="op">,</span> <span
                            class="nam">middle_x</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t356"><span class="nam">fst_complete_quarter</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">:</span><span class="nam">middle_y</span>
                    <span class="op">-</span> <span
                            class="nam">margin</span><span class="op">,</span>
                    <span class="num">0</span><span class="op">:</span><span
                            class="nam">middle_x</span> <span
                            class="op">-</span> <span class="nam">margin</span><span
                            class="op">]</span> <span class="op">=</span> <span
                            class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t357"><span
                        class="nam">first_quarter_mask</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t358"><span class="nam">snd_complete_quarter</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">:</span><span class="nam">middle_y</span>
                    <span class="op">-</span> <span
                            class="nam">margin</span><span class="op">,</span>
                    <span class="nam">margin</span><span
                            class="op">:</span><span
                            class="nam">middle_x</span><span
                            class="op">]</span> <span class="op">=</span> <span
                            class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t359"><span
                        class="nam">second_quarter_mask</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t360"><span class="nam">reverse_array_x</span>
                    <span class="op">=</span> <span class="op">(</span><span
                            class="nam">middle_x</span> <span
                            class="op">-</span> <span class="num">1</span><span
                            class="op">)</span> <span class="op">-</span> <span
                            class="nam">np</span><span class="op">.</span><span
                            class="nam">arange</span><span
                            class="op">(</span><span class="num">0</span><span
                            class="op">,</span> <span
                            class="nam">middle_x</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t361"><span class="nam">reverse_array_y</span>
                    <span class="op">=</span> <span class="op">(</span><span
                            class="nam">middle_y</span> <span
                            class="op">-</span> <span class="num">1</span><span
                            class="op">)</span> <span class="op">-</span> <span
                            class="nam">np</span><span class="op">.</span><span
                            class="nam">arange</span><span
                            class="op">(</span><span class="num">0</span><span
                            class="op">,</span> <span
                            class="nam">middle_y</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t362"><span
                        class="nam">indices</span> <span class="op">=</span>
                    <span class="nam">np</span><span class="op">.</span><span
                            class="nam">ix_</span><span
                            class="op">(</span><span class="nam">reverse_array_y</span><span
                            class="op">,</span> <span class="nam">reverse_array_x</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t363"><span class="nam">fth_complete_quarter</span>
                    <span class="op">=</span> <span class="nam">fst_complete_quarter</span><span
                            class="op">[</span><span class="nam">indices</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t364"><span class="nam">trd_complete_quarter</span>
                    <span class="op">=</span> <span class="nam">snd_complete_quarter</span><span
                            class="op">[</span><span class="nam">indices</span><span
                            class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t365"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t366"><span class="nam">masks_fourier</span>
                    <span class="op">=</span> <span class="nam">np</span><span
                            class="op">.</span><span
                            class="nam">zeros</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="num">2</span> <span class="op">*</span>
                    <span class="nam">middle_y</span> <span class="op">+</span>
                    <span class="nam">y_odd</span><span class="op">,</span>
                    <span class="num">2</span> <span class="op">*</span> <span
                            class="nam">middle_x</span> <span
                            class="op">+</span> <span
                            class="nam">x_odd</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t367"><span class="nam">masks_fourier</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">:</span><span
                        class="nam">middle_y</span><span class="op">,</span>
                    <span class="num">0</span><span class="op">:</span><span
                            class="nam">middle_x</span><span
                            class="op">]</span> <span class="op">=</span> <span
                            class="nam">fst_complete_quarter</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t368"><span class="nam">masks_fourier</span><span
                        class="op">[</span><span class="num">0</span><span
                        class="op">:</span><span
                        class="nam">middle_y</span><span class="op">,</span>
                    <span class="nam">middle_x</span> <span class="op">+</span>
                    <span class="nam">x_odd</span><span
                            class="op">:</span><span class="nam">nx</span><span
                            class="op">]</span> <span class="op">=</span> <span
                            class="nam">snd_complete_quarter</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t369"><span class="nam">masks_fourier</span><span
                        class="op">[</span><span class="nam">middle_y</span>
                    <span class="op">+</span> <span
                            class="nam">y_odd</span><span
                            class="op">:</span><span class="nam">ny</span><span
                            class="op">,</span> <span class="num">0</span><span
                            class="op">:</span><span
                            class="nam">middle_x</span><span
                            class="op">]</span> <span class="op">=</span> <span
                            class="nam">trd_complete_quarter</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t370"><span class="nam">masks_fourier</span><span
                        class="op">[</span><span class="nam">middle_y</span>
                    <span class="op">+</span> <span
                            class="nam">y_odd</span><span
                            class="op">:</span><span class="nam">ny</span><span
                            class="op">,</span> <span
                            class="nam">middle_x</span> <span
                            class="op">+</span> <span
                            class="nam">x_odd</span><span
                            class="op">:</span><span class="nam">nx</span><span
                            class="op">]</span> <span class="op">=</span> <span
                            class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t371"><span
                        class="nam">fth_complete_quarter</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t372"><span class="nam">complement_mask_fourier</span>
                    <span class="op">=</span> <span class="num">1</span> <span
                            class="op">-</span> <span
                            class="nam">masks_fourier</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t373"><span class="nam">fourier_transform_corrected</span>
                    <span class="op">=</span> <span class="nam">fourier_transform_shifted</span>
                    <span class="xx">\</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t374"><span class="op">*</span> <span
                        class="nam">complement_mask_fourier</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t375"><span
                        class="nam">shifted</span> <span class="op">=</span>
                    <span class="nam">fftpack</span><span
                            class="op">.</span><span
                            class="nam">ifftshift</span><span
                            class="op">(</span><span class="nam">fourier_transform_corrected</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t376"><span class="nam">corrected_image</span>
                    <span class="op">=</span> <span
                            class="nam">fftpack</span><span class="op">.</span><span
                            class="nam">ifft2</span><span
                            class="op">(</span><span class="nam">shifted</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t377"><span
                        class="key">return</span> <span class="nam">corrected_image</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t378"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t379"><span
                        class="key">def</span> <span
                        class="nam">process_srtm</span><span
                        class="op">(</span><span
                        class="nam">srtm_fourier</span><span
                        class="op">,</span> <span
                        class="nam">tree_class_file</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t380"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t381"><span class="str">    Perform the processing corresponding to SRTM file.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t382"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t383"><span class="nam">srtm_fourier_sua</span>
                    <span class="op">=</span> <span class="nam">quadratic_filter</span><span
                            class="op">(</span><span
                            class="nam">srtm_fourier</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t384"><span class="nam">dem_highlighted</span>
                    <span class="op">=</span> <span
                            class="nam">srtm_fourier</span> <span
                            class="op">-</span> <span class="nam">srtm_fourier_sua</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t385"><span class="nam">mask_height_greater_than_15_mt</span>
                    <span class="op">=</span> <span class="op">(</span><span
                            class="nam">dem_highlighted</span> <span
                            class="op">></span> <span
                            class="num">1.5</span><span class="op">)</span>
                    <span class="op">*</span> <span class="num">1.0</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t386"><span class="com"># TODO: Uniformizar, input, uno entrada otro path</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t387"><span class="nam">tree_class_raw</span>
                    <span class="op">=</span> <span
                            class="nam">gdal</span><span
                            class="op">.</span><span
                            class="nam">Open</span><span
                            class="op">(</span><span class="nam">tree_class_file</span><span
                            class="op">)</span><span class="op">.</span><span
                            class="nam">ReadAsArray</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t388"><span class="nam">tree_class</span>
                    <span class="op">=</span> <span
                            class="nam">ndimage</span><span class="op">.</span><span
                            class="nam">binary_closing</span><span
                            class="op">(</span><span
                            class="nam">tree_class_raw</span><span
                            class="op">,</span> <span
                            class="nam">np</span><span class="op">.</span><span
                            class="nam">ones</span><span
                            class="op">(</span><span class="op">(</span><span
                            class="num">3</span><span class="op">,</span> <span
                            class="num">3</span><span class="op">)</span><span
                            class="op">)</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t389"><span class="nam">tree_class_height_15_mt</span>
                    <span class="op">=</span> <span
                            class="nam">tree_class</span> <span
                            class="op">*</span> <span class="nam">mask_height_greater_than_15_mt</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t390"><span class="nam">tree_class_height_15_mt_compl</span>
                    <span class="op">=</span> <span class="num">1</span> <span
                            class="op">-</span> <span class="nam">tree_class_height_15_mt</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t391"><span class="nam">trees_removed</span>
                    <span class="op">=</span> <span
                            class="nam">dem_highlighted</span> <span
                            class="op">*</span> <span class="nam">tree_class_height_15_mt_compl</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t392"><span class="nam">dem_corrected_15</span>
                    <span class="op">=</span> <span
                            class="nam">trees_removed</span> <span
                            class="op">+</span> <span class="nam">srtm_fourier_sua</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t393"><span
                        class="key">return</span> <span class="nam">dem_corrected_15</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t394"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t395"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t396"><span
                        class="key">def</span> <span class="nam">resample_and_cut</span><span
                        class="op">(</span><span
                        class="nam">orig_image</span><span class="op">,</span>
                    <span class="nam">shape_file</span><span
                            class="op">,</span> <span
                            class="nam">target_path</span><span
                            class="op">)</span><span class="op">:</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t397"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t398"><span class="str">    Resample the DEM to corresponding projection.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t399"><span class="str">    Cut the area defined by shape</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t400"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t401"><span class="nam">gdal_warp</span>
                    <span class="op">=</span> <span
                            class="str">"gdalwarp.exe"</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t402"><span
                        class="nam">proj</span> <span class="op">=</span> <span
                        class="str">'"+proj=tmerc +lat_0=-90 +lon_0=-63 +k=1 +x_0=4500000 +y_0=0 '</span>
                    <span class="xx">\</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t403"><span class="str">'+ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"'</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t404"><span class="nam">pixel_size</span>
                    <span class="op">=</span> <span class="num">90</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t405"><span class="nam">command_line</span>
                    <span class="op">=</span> <span
                            class="nam">gdal_warp</span> <span
                            class="op">+</span> <span
                            class="str">' -t_srs '</span> <span
                            class="op">+</span> <span class="nam">proj</span>
                    <span class="op">+</span> <span class="str">' '</span>
                    <span class="op">+</span> <span
                            class="nam">orig_image</span> <span
                            class="op">+</span> <span class="str">' '</span>
                    <span class="xx">\</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t406"><span class="op">+</span> <span
                        class="nam">TEMP_REPROJECTED_TO_CUT</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t407"><span
                        class="nam">os</span><span class="op">.</span><span
                        class="nam">system</span><span class="op">(</span><span
                        class="nam">command_line</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t408"><span class="nam">command_line</span>
                    <span class="op">=</span> <span
                            class="nam">gdal_warp</span> <span
                            class="op">+</span> <span
                            class="str">" -cutline "</span> <span
                            class="op">+</span> <span
                            class="nam">shape_file</span> <span
                            class="op">+</span> <span class="str">" -crop_to_cutline "</span>
                    <span class="op">+</span> <span class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t409"><span class="nam">TEMP_REPROJECTED_TO_CUT</span>
                    <span class="op">+</span> <span class="str">" "</span>
                    <span class="op">+</span> <span
                            class="nam">target_path</span> <span
                            class="op">+</span> <span
                            class="str">" -tr "</span> <span
                            class="op">+</span> <span class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t410"><span class="nam">str</span><span
                        class="op">(</span><span
                        class="nam">pixel_size</span><span class="op">)</span>
                    <span class="op">+</span> <span class="str">" "</span>
                    <span class="op">+</span> <span class="nam">str</span><span
                            class="op">(</span><span
                            class="nam">pixel_size</span><span
                            class="op">)</span> <span class="op">+</span> <span
                            class="str">" -ot Float32"</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t411"><span
                        class="nam">os</span><span class="op">.</span><span
                        class="nam">system</span><span class="op">(</span><span
                        class="nam">command_line</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t412"><span
                        class="key">try</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t413"><span
                        class="nam">os</span><span class="op">.</span><span
                        class="nam">remove</span><span class="op">(</span><span
                        class="nam">TEMP_REPROJECTED_TO_CUT</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm mis" id="t414"><span class="key">except</span>
                    <span class="nam">OSError</span><span
                            class="op">:</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm mis" id="t415"><span class="key">pass</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t416"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t417"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t418"><span
                        class="key">def</span> <span class="nam">calling_system_call</span><span
                        class="op">(</span><span
                        class="nam">command_line</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t419"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t420"><span class="str">    Execute command line in operative system call</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t421"><span class="str">    :param command_line: sentence to execute</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t422"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t423"><span class="nam">command_line_list</span>
                    <span class="op">=</span> <span
                            class="nam">command_line</span><span
                            class="op">.</span><span
                            class="nam">split</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t424"><span class="com"># FNULL = open(os.devnull, 'w')</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t425"><span class="com"># subprocess.call(command_line_list, stdout=FNULL, stderr=subprocess.STDOUT)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t426"><span class="nam">subprocess</span><span
                        class="op">.</span><span class="nam">call</span><span
                        class="op">(</span><span
                        class="nam">command_line_list</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t427"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t428"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t429"><span
                        class="key">def</span> <span class="nam">get_shape_over_area</span><span
                        class="op">(</span><span
                        class="nam">image_temp</span><span class="op">,</span>
                    <span class="nam">shape_over_area</span><span
                            class="op">)</span><span class="op">:</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t430"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t431"><span class="str">    Return a rectangular shape file covering all area of interest and</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t432"><span class="str">    parallel to the equator.</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t433"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t434"><span class="nam">shape_over_without_extension</span>
                    <span class="op">=</span> <span class="nam">os</span><span
                            class="op">.</span><span
                            class="nam">path</span><span
                            class="op">.</span><span
                            class="nam">splitext</span><span
                            class="op">(</span><span class="nam">shape_over_area</span><span
                            class="op">)</span><span class="op">[</span><span
                            class="num">0</span><span class="op">]</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t435"><span class="nam">file_list</span>
                    <span class="op">=</span> <span
                            class="nam">glob</span><span
                            class="op">.</span><span
                            class="nam">glob</span><span
                            class="op">(</span><span class="nam">shape_over_without_extension</span>
                    <span class="op">+</span> <span
                            class="str">".*"</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t436"><span
                        class="key">for</span> <span
                        class="nam">file_path</span> <span
                        class="key">in</span> <span
                        class="nam">file_list</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t437"><span
                        class="key">try</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t438"><span
                        class="nam">os</span><span class="op">.</span><span
                        class="nam">remove</span><span class="op">(</span><span
                        class="nam">file_path</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm mis" id="t439"><span
                        class="key">except</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm mis" id="t440"><span
                        class="key">print</span><span class="op">(</span><span
                        class="str">"Error while deleting file : "</span><span
                        class="op">,</span> <span
                        class="nam">file_path</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t441"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t442"><span
                        class="nam">command</span> <span class="op">=</span>
                    <span class="str">'gdaltindex '</span> <span
                            class="op">+</span> <span class="nam">shape_over_area</span>
                    <span class="op">+</span> <span class="str">' '</span>
                    <span class="op">+</span> <span
                            class="nam">image_temp</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t443"><span class="nam">calling_system_call</span><span
                        class="op">(</span><span
                        class="nam">command</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t444"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t445"><span
                        class="key">def</span> <span class="nam">get_lagoons_hsheds</span><span
                        class="op">(</span><span
                        class="nam">hsheds_input</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t446"><span class="nam">hsheds_maj_filter11</span>
                    <span class="op">=</span> <span
                            class="nam">majority_filter</span><span class="op">(</span><span
                            class="nam">hsheds_input</span><span
                            class="op">,</span> <span
                            class="num">11</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t447"><span class="nam">hsheds_maj_filter11_ero2</span>
                    <span class="op">=</span> <span
                            class="nam">ndimage</span><span class="op">.</span><span
                            class="nam">binary_erosion</span><span
                            class="op">(</span><span class="nam">hsheds_maj_filter11</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t448"><span
                        class="nam">iterations</span><span
                        class="op">=</span><span class="num">2</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t449"><span class="nam">hsheds_maj_filter11_ero2_expand7</span>
                    <span class="op">=</span> <span
                            class="nam">expand_filter</span><span
                            class="op">(</span><span class="nam">hsheds_maj_filter11_ero2</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t450"><span class="num">7</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t451"><span class="nam">hsheds_maj11_ero2_expand7_prod_maj11</span>
                    <span class="op">=</span> <span class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t452"><span class="nam">hsheds_maj_filter11_ero2_expand7</span>
                    <span class="op">*</span> <span class="nam">hsheds_maj_filter11</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t453"><span class="nam">hsheds_mask_lagoons_values</span>
                    <span class="op">=</span> <span
                            class="nam">ndimage</span><span class="op">.</span><span
                            class="nam">grey_dilation</span><span
                            class="op">(</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t454"><span class="nam">hsheds_maj11_ero2_expand7_prod_maj11</span><span
                        class="op">,</span> <span class="nam">size</span><span
                        class="op">=</span><span class="op">(</span><span
                        class="num">7</span><span class="op">,</span> <span
                        class="num">7</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t455"><span
                        class="key">return</span> <span class="nam">hsheds_mask_lagoons_values</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t456"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t457"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t458"><span
                        class="key">def</span> <span class="nam">clip_lines_vector</span><span
                        class="op">(</span><span
                        class="nam">lines_vector</span><span
                        class="op">,</span> <span
                        class="nam">polygon_vector</span><span
                        class="op">,</span> <span
                        class="nam">lines_output</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t459"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t460"><span class="str">    Clip a lines vector file using polygon vector file</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t461"><span class="str">    :param lines_vector: lines vector file to clip</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t462"><span class="str">    :param polygon_vector: polygon to use as a clipper</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t463"><span class="str">    :param lines_output: line vector file clipped</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t464"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t465"><span class="nam">rivers_driver</span>
                    <span class="op">=</span> <span class="nam">ogr</span><span
                            class="op">.</span><span class="nam">GetDriverByName</span><span
                            class="op">(</span><span class="str">"ESRI Shapefile"</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t466"><span class="nam">dataSource_rivers</span>
                    <span class="op">=</span> <span
                            class="nam">rivers_driver</span><span
                            class="op">.</span><span
                            class="nam">Open</span><span
                            class="op">(</span><span
                            class="nam">lines_vector</span><span
                            class="op">,</span> <span class="num">0</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t467"><span class="nam">rivers_layer</span>
                    <span class="op">=</span> <span class="nam">dataSource_rivers</span><span
                            class="op">.</span><span
                            class="nam">GetLayer</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t468"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t469"><span class="nam">area_driver</span>
                    <span class="op">=</span> <span class="nam">ogr</span><span
                            class="op">.</span><span class="nam">GetDriverByName</span><span
                            class="op">(</span><span class="str">"ESRI Shapefile"</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t470"><span class="nam">dataSource_area</span>
                    <span class="op">=</span> <span
                            class="nam">area_driver</span><span
                            class="op">.</span><span
                            class="nam">Open</span><span
                            class="op">(</span><span
                            class="nam">polygon_vector</span><span
                            class="op">,</span> <span class="num">0</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t471"><span class="nam">area_layer</span>
                    <span class="op">=</span> <span
                            class="nam">dataSource_area</span><span class="op">.</span><span
                            class="nam">GetLayer</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t472"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t473"><span class="com"># Create the output Layer</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t474"><span class="nam">outDriver</span>
                    <span class="op">=</span> <span class="nam">ogr</span><span
                            class="op">.</span><span class="nam">GetDriverByName</span><span
                            class="op">(</span><span class="str">"ESRI Shapefile"</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t475"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t476"><span
                        class="nam">srs</span> <span class="op">=</span> <span
                        class="nam">osr</span><span class="op">.</span><span
                        class="nam">SpatialReference</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t477"><span
                        class="nam">srs</span><span class="op">.</span><span
                        class="nam">ImportFromWkt</span><span
                        class="op">(</span><span
                        class="nam">rivers_layer</span><span
                        class="op">.</span><span
                        class="nam">GetSpatialRef</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">.</span><span class="nam">ExportToWkt</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t478"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t479"><span class="com"># Remove output shapefile if it already exists</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t480"><span
                        class="key">if</span> <span class="nam">os</span><span
                        class="op">.</span><span class="nam">path</span><span
                        class="op">.</span><span class="nam">exists</span><span
                        class="op">(</span><span
                        class="nam">lines_output</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t481"><span class="nam">outDriver</span><span
                        class="op">.</span><span
                        class="nam">DeleteDataSource</span><span
                        class="op">(</span><span
                        class="nam">lines_output</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t482"><span class="com"># Create the output shapefile</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t483"><span class="nam">outDataSource</span>
                    <span class="op">=</span> <span
                            class="nam">outDriver</span><span
                            class="op">.</span><span class="nam">CreateDataSource</span><span
                            class="op">(</span><span
                            class="nam">lines_output</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t484"><span class="nam">outLayer</span>
                    <span class="op">=</span> <span
                            class="nam">outDataSource</span><span
                            class="op">.</span><span
                            class="nam">CreateLayer</span><span
                            class="op">(</span><span class="str">"rivers_clipped"</span><span
                            class="op">,</span> <span
                            class="nam">srs</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t485"><span
                        class="nam">geom_type</span><span
                        class="op">=</span><span class="nam">ogr</span><span
                        class="op">.</span><span
                        class="nam">wkbLineString</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t486"><span class="com"># Clip</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t487"><span class="nam">rivers_layer</span><span
                        class="op">.</span><span class="nam">Clip</span><span
                        class="op">(</span><span
                        class="nam">area_layer</span><span class="op">,</span>
                    <span class="nam">outLayer</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t488"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t489"><span
                        class="com"># Close DataSources</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t490"><span class="nam">dataSource_rivers</span><span
                        class="op">.</span><span
                        class="nam">Destroy</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t491"><span class="nam">dataSource_area</span><span
                        class="op">.</span><span
                        class="nam">Destroy</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t492"><span class="nam">outDataSource</span><span
                        class="op">.</span><span
                        class="nam">Destroy</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t493"><span class="strut">&nbsp;</span></p>
                <p class="pln" id="t494"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t495"><span
                        class="key">def</span> <span
                        class="nam">process_rivers</span><span
                        class="op">(</span><span class="nam">hsheds_area_interest</span><span
                        class="op">,</span> <span class="nam">hsheds_mask_lagoons</span><span
                        class="op">,</span> <span
                        class="nam">rivers_shape</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t496"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t497"><span class="str">    Get rivers from hsheds DEM</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t498"><span class="str">    :param hsheds_area_interest: DEM HSHEDS to get rivers</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t499"><span class="str">    :param hsheds_mask_lagoons: Mask Lagoons to exclude from rivers</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t500"><span class="str">    :return: Rivers detected</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t501"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t502"><span
                        class="nam">cols</span> <span class="op">=</span> <span
                        class="nam">hsheds_mask_lagoons</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">1</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t503"><span
                        class="nam">rows</span> <span class="op">=</span> <span
                        class="nam">hsheds_mask_lagoons</span><span class="op">.</span><span
                        class="nam">shape</span><span class="op">[</span><span
                        class="num">0</span><span class="op">]</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t504"><span class="com"># Convert to Raster Rivers</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t505"><span class="nam">command_line</span>
                    <span class="op">=</span> <span class="str">'gdal_rasterize -a UP_CELLS -ts '</span>
                    <span class="op">+</span> <span class="nam">str</span><span
                            class="op">(</span><span
                            class="nam">cols</span><span class="op">)</span>
                    <span class="op">+</span> <span class="str">' '</span>
                    <span class="op">+</span> <span class="xx">\</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t506"><span class="nam">str</span><span
                        class="op">(</span><span class="nam">rows</span><span
                        class="op">)</span> <span class="op">+</span> <span
                        class="str">' -l rivers_area_interest '</span> <span
                        class="op">+</span> <span
                        class="nam">rivers_shape</span> <span
                        class="op">+</span> <span class="xx">\</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t507"><span class="str">' '</span> <span
                        class="op">+</span> <span class="nam">RIVERS_TIF</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t508"><span class="nam">calling_system_call</span><span
                        class="op">(</span><span
                        class="nam">command_line</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="pln" id="t509"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t510"><span class="nam">river_array</span>
                    <span class="op">=</span> <span
                            class="nam">gdal</span><span
                            class="op">.</span><span
                            class="nam">Open</span><span
                            class="op">(</span><span
                            class="nam">RIVERS_TIF</span><span
                            class="op">)</span><span class="op">.</span><span
                            class="nam">ReadAsArray</span><span
                            class="op">(</span><span class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t511"><span class="nam">mask_canyons_array</span>
                    <span class="op">=</span> <span class="op">(</span><span
                            class="nam">river_array</span> <span
                            class="op">></span> <span class="num">0</span><span
                            class="op">)</span> <span class="op">*</span> <span
                            class="num">1</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t512"><span class="nam">mask_canyons_expanded3</span>
                    <span class="op">=</span> <span
                            class="nam">expand_filter</span><span
                            class="op">(</span><span class="nam">mask_canyons_array</span><span
                            class="op">,</span> <span class="num">3</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t513"><span class="nam">rivers_routed</span>
                    <span class="op">=</span> <span
                            class="nam">route_rivers</span><span
                            class="op">(</span><span class="nam">hsheds_area_interest</span><span
                            class="op">,</span> <span class="nam">mask_canyons_expanded3</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t514"><span class="num">3</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t515"><span class="nam">rivers_routed_closing</span>
                    <span class="op">=</span> <span
                            class="nam">binary_closing</span><span
                            class="op">(</span><span
                            class="nam">rivers_routed</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t516"><span class="nam">intersection_lag_can</span>
                    <span class="op">=</span> <span class="nam">rivers_routed_closing</span>
                    <span class="op">*</span> <span class="nam">hsheds_mask_lagoons</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t517"><span class="nam">intersection_lag_can_mask</span>
                    <span class="op">=</span> <span class="op">(</span><span
                            class="nam">intersection_lag_can</span> <span
                            class="op">></span> <span class="num">0</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t518"><span class="nam">rivers_routed_closing</span>
                    <span class="op">-=</span> <span class="nam">intersection_lag_can_mask</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t519"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t520"><span
                        class="key">return</span> <span class="nam">rivers_routed_closing</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t521"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t522"><span
                        class="key">def</span> <span class="nam">uncompress_zip_file</span><span
                        class="op">(</span><span
                        class="nam">zip_file</span><span
                        class="op">)</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t523"><span class="str">"""</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t524"><span class="str">    Uncompress zip file</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t525"><span class="str">    :param zip_file: path where file to uncompress is located</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t526"><span class="str">    """</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t527"><span class="nam">dir_name</span>
                    <span class="op">=</span> <span class="nam">os</span><span
                            class="op">.</span><span
                            class="nam">path</span><span
                            class="op">.</span><span class="nam">dirname</span><span
                            class="op">(</span><span
                            class="nam">zip_file</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t528"><span
                        class="nam">zip_ref</span> <span class="op">=</span>
                    <span class="nam">zipfile</span><span
                            class="op">.</span><span class="nam">ZipFile</span><span
                            class="op">(</span><span
                            class="nam">zip_file</span><span
                            class="op">,</span> <span
                            class="str">'r'</span><span
                            class="op">)</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t529"><span
                        class="nam">zip_ref</span><span
                        class="op">.</span><span
                        class="nam">extractall</span><span
                        class="op">(</span><span
                        class="nam">dir_name</span><span
                        class="op">)</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t530"><span
                        class="nam">zip_ref</span><span
                        class="op">.</span><span class="nam">close</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="pln" id="t531"><span class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t532"><span
                        class="key">def</span> <span class="nam">clean_workspace</span><span
                        class="op">(</span><span class="op">)</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t533"><span class="nam">to_clean</span>
                    <span class="op">=</span> <span class="op">[</span><span
                            class="nam">TREE_CLASS_AREA</span><span class="op">,</span>
                    <span class="nam">SRTM_AREA_INTEREST_OVER</span><span
                            class="op">,</span><span
                            class="strut">&nbsp;</span></p>
                <p class="pln" id="t534"><span class="nam">HSHEDS_AREA_INTEREST_OVER</span><span
                        class="op">]</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t535"><span
                        class="key">for</span> <span class="nam">file</span>
                    <span class="key">in</span> <span
                            class="nam">to_clean</span><span
                            class="op">:</span><span
                            class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t536"><span
                        class="key">try</span><span class="op">:</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t537"><span
                        class="nam">os</span><span class="op">.</span><span
                        class="nam">remove</span><span class="op">(</span><span
                        class="nam">file</span><span class="op">)</span><span
                        class="strut">&nbsp;</span></p>
                <p class="stm run hide_run" id="t538"><span
                        class="key">except</span> <span
                        class="nam">OSError</span><span
                        class="op">:</span><span class="strut">&nbsp;</span>
                </p>
                <p class="stm run hide_run" id="t539"><span
                        class="key">pass</span><span
                        class="strut">&nbsp;</span></p>

            </td>
        </tr>
    </table>
</div>

<div id="footer">
    <div class="content">
        <p>
            <a class="nav" href="index.html">&#xab; index</a> &nbsp; &nbsp; <a
                class="nav" href="https://coverage.readthedocs.io">coverage.py
            v4.5.1</a>,
            created at 2019-07-28 21:17
        </p>
    </div>
</div>

</body>
</html>
